<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="theme-color" content="#667eea">
    <title>MataBanq</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
    <!-- Page de connexion -->
    <div id="login-page" class="page active">
        <div class="login-container">
            <div class="login-card">
                <div class="login-header">
                    <i class="fas fa-wallet"></i>
                    <h1>Gestion des D√©penses</h1>
                </div>
                <form id="login-form">
                                            <div class="form-group">
                            <label for="username">Nom d'utilisateur</label>
                            <input type="text" id="username" name="username" autocomplete="username" required>
                        </div>
                        <div class="form-group">
                            <label for="password">Mot de passe</label>
                            <input type="password" id="password" name="password" autocomplete="current-password" required>
                        </div>
                    <button type="submit">Se connecter</button>
                </form>
                <div id="login-error" class="error-message"></div>
               
            </div>
        </div>
    </div>

    <!-- Application principale -->
    <div id="app" class="page">
        <!-- Navigation -->
        <nav class="navbar">
            <div class="nav-brand">
                <button class="mobile-menu-toggle" id="mobile-menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                <!--<img src="matabanq_logo.svg" alt="MataBanq Logo" class="app-logo">-->
                <span class="brand-title">MataBanq</span>
            </div>
            <div class="nav-user">
                <span id="user-name"></span>
                <span id="user-role" class="role-badge"></span>
                <button id="logout-btn" class="btn-logout">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </nav>

        <!-- Contenu principal -->
        <div class="main-content">
            <!-- Overlay pour mobile -->
            <div class="sidebar-overlay" id="sidebar-overlay"></div>
            
            <!-- Menu lat√©ral -->
            <aside class="sidebar" id="sidebar">
                <ul class="nav-menu">
                    <!-- üìä SUIVI & TABLEAU DE BORD -->
                    <li class="menu-section-title collapsible" data-section-group="dashboard-group">
                        <span><i class="fas fa-chart-bar"></i> SUIVI & TABLEAU DE BORD <i class="fas fa-chevron-down chevron"></i></span>
                    </li>
                    <ul class="section-group" data-group="dashboard-group">
                        <li><a href="#" data-section="dashboard" class="nav-link active">
                            <i class="fas fa-tachometer-alt"></i> Tableau de bord
                        </a></li>
                        <li id="visualisation-menu" style="display: none;">
                            <a href="#" data-section="visualisation" class="nav-link">
                                <i class="fas fa-chart-line"></i> Visualisation
                            </a>
                        </li>
                        <li>
                            <a href="#" data-section="partner-tracking" class="nav-link">
                                <i class="fas fa-handshake"></i> Suivi Partenaires
                            </a>
                        </li>
                        <li id="audit-flux-menu" style="display: none;">
                            <a href="#" data-section="audit-flux" class="nav-link">
                                <i class="fas fa-search-dollar"></i> Audit Flux
                            </a>
                        </li>
                        <li>
                            <a href="#" data-section="snapshots-history" class="nav-link">
                                <i class="fas fa-history"></i> Historique
                            </a>
                        </li>
                    </ul>
                    <!-- üíµ GESTION FINANCI√àRE -->
                    <li class="menu-section-title collapsible" data-section-group="finance-group">
                        <span><i class="fas fa-money-check"></i> GESTION FINANCI√àRE <i class="fas fa-chevron-down chevron"></i></span>
                    </li>
                    <ul class="section-group" data-group="finance-group">
                        <li><a href="#" data-section="expenses" class="nav-link">
                            <i class="fas fa-receipt"></i> Mes D√©penses
                        </a></li>
                        <li><a href="#" data-section="add-expense" class="nav-link">
                            <i class="fas fa-plus"></i> Ajouter D√©pense
                        </a></li>
                        <li id="credit-menu" style="display: none;">
                            <a href="#" data-section="credit-account" class="nav-link">
                                <i class="fas fa-credit-card"></i> Cr√©diter Compte
                            </a>
                        </li>
                        <li id="transfert-menu" style="display: none;">
                            <a href="#" data-section="transfert" class="nav-link">
                                <i class="fas fa-exchange-alt"></i> Transfert
                            </a>
                        </li>
                        <li id="creance-menu" style="display: none;">
                            <a href="#" data-section="creance" class="nav-link">
                                <i class="fas fa-money-check-alt"></i> Cr√©ance
                            </a>
                        </li>
                        <li id="cash-bictorys-menu" style="display: none;">
                            <a href="#" data-section="cash-bictorys" class="nav-link">
                                <i class="fas fa-money-bill-wave"></i> Cash Bictorys Mois
                            </a>
                        </li>
                        <li id="montant-debut-mois-menu" style="display: none;">
                            <a href="#" data-section="montant-debut-mois" class="nav-link">
                                <i class="fas fa-calendar-alt"></i> Montant d√©but de mois
                            </a>
                        </li>
                        <li id="admin-menu" style="display: none;">
                            <a href="#" data-section="manage-accounts" class="nav-link">
                                <i class="fas fa-users-cog"></i> G√©rer Comptes
                            </a>
                        </li>
                    </ul>
                    <!-- üè™ GESTION DES STOCKS -->
                    <li class="menu-section-title collapsible" data-section-group="stock-group">
                        <span><i class="fas fa-warehouse"></i> GESTION DES STOCKS <i class="fas fa-chevron-down chevron"></i></span>
                    </li>
                    <ul class="section-group" data-group="stock-group">
                        <li id="stock-menu" style="display: none;">
                            <a href="#" data-section="stock-soir" class="nav-link">
                                <i class="fas fa-warehouse"></i> Gestion Stock
                            </a>
                        </li>
                        <li id="stock-vivant-menu" style="display: none;">
                            <a href="#" data-section="stock-vivant" class="nav-link">
                                <i class="fas fa-seedling"></i> Stock Vivant
                            </a>
                        </li>
                    </ul>
                    <!-- ‚öôÔ∏è PARAM√âTRAGE -->
                    <li class="menu-section-title collapsible" data-section-group="param-group">
                        <span><i class="fas fa-cogs"></i> PARAM√âTRAGE <i class="fas fa-chevron-down chevron"></i></span>
                    </li>
                    <ul class="section-group" data-group="param-group">
                        <li id="admin-users-menu" style="display: none;">
                            <a href="#" data-section="manage-users" class="nav-link">
                                <i class="fas fa-user-shield"></i> G√©rer Utilisateurs
                            </a>
                        </li>
                        <li id="admin-config-menu" style="display: none;">
                            <a href="#" data-section="admin-config" class="nav-link">
                                <i class="fas fa-cogs"></i> Config
                            </a>
                        </li>
                    </ul>
                </ul>
            </aside>

            <!-- Zone de contenu -->
            <main class="content">
                <!-- Tableau de bord -->
                <section id="dashboard-section" class="section active">
                    <h2>Tableau de bord de Suivi</h2>
                    
                    <!-- S√©lecteur de mois pour gestion mensuelle -->
                    <div class="month-selector">
                        <div class="form-group">
                            <label for="dashboard-month">
                                <i class="fas fa-calendar-alt"></i> Mois de gestion
                            </label>
                            <input type="month" id="dashboard-month" class="form-control">
                        </div>
                        <button id="load-month-data" class="btn btn-primary">
                            <i class="fas fa-refresh"></i> Charger le mois
                        </button>
                      
                        <div class="month-info">
                            <span id="current-month-display"></span>
                        </div>
                    </div>

                    <!-- Sauvegarde des donn√©es du tableau de bord -->
                    <div class="dashboard-save-section" id="dashboard-save-section" style="display: none;">
                        <div class="save-controls">
                            <div class="form-group">
                                <label for="snapshot-date">
                                    <i class="fas fa-save"></i> Sauvegarder les donn√©es pour le
                                </label>
                                <input type="date" id="snapshot-date" class="form-control">
                            </div>
                            <div class="form-group">
                                <input type="text" id="snapshot-notes" class="form-control" placeholder="Notes (optionnel)">
                            </div>
                            <button id="save-dashboard-snapshot" class="btn btn-success">
                                <i class="fas fa-download"></i> Sauvegarder Snapshot
                            </button>
                        </div>
                    </div>
                    
                    <div class="stats-grid">
                        <!-- Cartes principales (toujours visibles) -->
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-calendar-day"></i>
                            </div>
                            <div class="stat-content">
                                <h3>Cash disponible 
                                    <button class="info-btn" id="cash-info-btn" title="Voir le d√©tail du calcul">
                                        <i class="fas fa-info-circle"></i>
                                    </button>
                                </h3>
                                <p class="stat-value" id="solde-amount">0 FCFA</p>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-balance-scale"></i>
                            </div>
                            <div class="stat-content">
                                <h3>Somme Balance du Mois</h3>
                                <p class="stat-value" id="monthly-balance-total">0 FCFA</p>
                                <small class="stat-period">Total des balances mensuelles</small>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-handshake"></i>
                            </div>
                            <div class="stat-content">
                                <h3>Solde Comptes Partenaire</h3>
                                <p class="stat-value" id="total-partner-balance">0 FCFA</p>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-calendar-alt"></i>
                            </div>
                            <div class="stat-content">
                                <h3>Cash Burn du Mois</h3>
                                <p class="stat-value" id="monthly-burn">0 FCFA</p>
                            </div>
                        </div>
                        
                        <div class="stat-card" id="cash-bictorys-card" style="display: none;">
                            <div class="stat-icon">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                            <div class="stat-content">
                                <h3>Cash Bictorys Du mois</h3>
                                <p class="stat-value" id="cash-bictorys-latest">0 FCFA</p>
                                <small class="stat-period">Derni√®re valeur</small>
                            </div>
                        </div>

                        <!-- Nouvelle carte PL avec estimation charges -->
                        <div class="stat-card" id="pl-estim-charges-card" style="display: none;" title="PL avec estimation charges fixes au prorata: Cash Bictorys + Cr√©ances + Stock PV + √âcart Stock Vivant Mensuel - Cash Burn - Estim. Charges Mensuelles Fixes - Livraisons partenaire du mois">
                            <div class="stat-icon">
                                <i class="fas fa-calculator"></i>
                            </div>
                            <div class="stat-content">
                                <h3>
                                    PL (avec ecart stock mensuel et une estim. charges)
                                    <i class="fas fa-info-circle pl-details-icon" id="pl-details-icon" title="Voir les d√©tails du calcul"></i>
                                </h3>
                                <p class="stat-value" id="pl-estim-charges">0 FCFA</p>
                            </div>
                        </div>

                        <!-- Nouvelle carte PL brut -->
                        <div class="stat-card" id="pl-brut-card" style="display: none;" title="PL brut avec √©cart stock mensuel: Cash Bictorys + Cr√©ances + Stock PV + √âcart Stock Vivant Mensuel - Cash Burn - Livraisons partenaire du mois">
                            <div class="stat-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="stat-content">
                                <h3>PL brut (avec ecart stock mensuel)</h3>
                                <p class="stat-value" id="pl-brut">0 FCFA</p>
                            </div>
                        </div>
                    </div>

                    <!-- Contr√¥les d'affichage des cartes additionnelles -->
                    <div class="dashboard-controls">
                        <button id="toggle-additional-cards" class="btn btn-secondary">
                            <i class="fas fa-eye"></i> Afficher toutes les cartes
                        </button>
                    </div>

                    <div class="stats-grid">
                        <!-- Cartes additionnelles (cach√©es par d√©faut) -->
                        <div class="stat-card additional-card" id="total-depot-balance-card" style="display: none;">
                            <div class="stat-icon">
                                <i class="fas fa-warehouse"></i>
                            </div>
                            <div class="stat-content">
                                <h3>Solde Comptes D√©p√¥t</h3>
                                <p class="stat-value" id="total-depot-balance">0 FCFA</p>
                            </div>
                        </div>
                        
                        <div class="stat-card additional-card" style="display: none;">
                            <div class="stat-icon">
                                <i class="fas fa-boxes"></i>
                            </div>
                            <div class="stat-content">
                                <h3>üì¶ √âcart Stock Mata Mensuel</h3>
                                <p class="stat-value" id="stock-total">0</p>
                                <small class="stat-period" id="stock-date">Derni√®re date</small>
                                <small class="stat-details" id="stock-mata-details" style="display: none; font-size: 0.75em; color: #666; margin-top: 4px;"></small>
                            </div>
                        </div>

                        <div class="stat-card additional-card" style="display: none;">
                            <div class="stat-icon">
                                <i class="fas fa-seedling"></i>
                            </div>
                            <div class="stat-content">
                                <h3>Total G√©n√©ral Stock Vivant</h3>
                                <p class="stat-value" id="stock-vivant-total">0 FCFA</p>
                                <small class="stat-period" id="stock-vivant-date">Derni√®re date</small>
                            </div>
                        </div>

                        <div class="stat-card additional-card" style="display: none;">
                            <div class="stat-icon">
                                <i class="fas fa-money-check-alt"></i>
                            </div>
                            <div class="stat-content">
                                <h3>Total Cr√©ances</h3>
                                <p class="stat-value" id="total-creances">0 FCFA</p>
                                <small class="stat-period">Soldes clients cr√©ance</small>
                            </div>
                        </div>

                        <div class="stat-card additional-card" style="display: none;">
                            <div class="stat-icon">
                                <i class="fas fa-calendar-week"></i>
                            </div>
                            <div class="stat-content">
                                <h3>Cash Burn depuis Lundi</h3>
                                <p class="stat-value" id="weekly-burn">0 FCFA</p>
                            </div>
                        </div>
                        
                        <div class="stat-card additional-card" style="display: none;">
                            <div class="stat-icon">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <div class="stat-content">
                                <h3>Cr√©ances du Mois</h3>
                                <p class="stat-value" id="creances-mois">0 FCFA</p>
                                <small class="stat-period" id="creances-mois-period">Mois en cours</small>
                            </div>
                        </div>

                        <!-- Nouvelle carte √âcart Stock Vivant Mensuel -->
                        <div class="stat-card additional-card" style="display: none;">
                            <div class="stat-icon">
                                <i class="fas fa-exchange-alt"></i>
                            </div>
                            <div class="stat-content">
                                <h3>üå± √âcart Stock Vivant Mensuel</h3>
                                <p class="stat-value" id="stock-vivant-variation">0 FCFA</p>
                                <small class="stat-period" id="stock-variation-period">Variation mois actuel vs pr√©c√©dent</small>
                                <small class="stat-details" id="stock-vivant-details" style="display: none; font-size: 0.75em; color: #666; margin-top: 4px;"></small>
                            </div>
                        </div>

                        <!-- Nouvelle carte PL (sans stock + charges) -->
                        <div class="stat-card additional-card" id="pl-sans-stock-charges-card" style="display: none;">
                            <div class="stat-icon">
                                <i class="fas fa-chart-pie"></i>
                            </div>
                            <div class="stat-content">
                                <h3>PL (sans stock + sans charges)</h3>
                                <p class="stat-value" id="pl-sans-stock-charges">0 FCFA</p>
                                <small class="stat-period">Cash Bictorys + Cr√©ances + Stock PV - Cash Burn</small>
                            </div>
                        </div>
                    </div>

                    <!-- Filtres de date pour le dashboard -->
                    <div class="dashboard-filters">
                        <div class="form-group">
                            <label for="dashboard-start-date">Date de d√©but</label>
                            <input type="date" id="dashboard-start-date">
                        </div>
                        <div class="form-group">
                            <label for="dashboard-end-date">Date de fin</label>
                            <input type="date" id="dashboard-end-date">
                        </div>
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="show-zero-accounts" onchange="onShowZeroAccountsChange()">
                                <span class="checkmark"></span>
                                Afficher les comptes avec z√©ro d√©penses
                            </label>
                        </div>
                        <button id="filter-dashboard" class="btn btn-primary">Actualiser</button>
                        <button id="reset-dashboard" class="btn btn-secondary">Aujourd'hui</button>
                    </div>

                    <!-- Cartes de statistiques -->
                    <div class="stats-cards">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-minus-circle"></i>
                            </div>
                            <div class="stat-content">
                                <h4>Montant D√©pens√© Total</h4>
                                <p class="stat-value" id="total-spent-amount">0 FCFA</p>
                                <small class="stat-period" id="spent-period">P√©riode s√©lectionn√©e</small>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-wallet"></i>
                            </div>
                            <div class="stat-content">
                                <h4>Montant Restant Total</h4>
                                <p class="stat-value" id="total-remaining-amount">0 FCFA</p>
                                <small class="stat-period" id="remaining-period">Soldes actuels</small>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-plus-circle"></i>
                            </div>
                            <div class="stat-content">
                                <h4>Total Cr√©dit√© avec D√©penses</h4>
                                <p class="stat-value" id="total-credited-with-expenses">0 FCFA</p>
                                <small class="stat-period" id="credited-expenses-period">Comptes avec activit√©</small>
                            </div>
                        </div>



                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="stat-content">
                                <h4>Total Cr√©dit√© G√©n√©ral</h4>
                                <p class="stat-value" id="total-credited-general">0 FCFA</p>
                                <small class="stat-period" id="credited-general-period">Tous les comptes</small>
                            </div>
                        </div>
                    </div>

                    <div class="charts-grid">
                        <div class="chart-card">
                            <h3>D√©tails par Compte</h3>
                            <div id="account-chart"></div>
                        </div>
                        
                        <div class="chart-card" id="transfers-chart-card" style="display: none;">
                            <h3>Transferts</h3>
                            <div id="transfers-list"></div>
                        </div>
                    </div>
                    
                    <div class="charts-grid">
                        <div class="chart-card">
                            <h3>D√©penses par Cat√©gorie</h3>
                            <div id="category-chart"></div>
                        </div>
                    </div>
                </section>

                <!-- Liste des d√©penses -->
                <section id="expenses-section" class="section">
                    <div class="expenses-header">
                        <h2>Mes D√©penses</h2>
                        <div id="expenses-total" class="expenses-total">
                            <span class="total-label">Total des d√©penses affich√©es :</span>
                            <span id="total-amount" class="total-amount">0 FCFA</span>
                        </div>
                    </div>
                    
                    <div class="filters">
                        <div class="form-row">
                        <div class="form-group">
                            <label for="filter-start-date">Date de d√©but</label>
                            <input type="date" id="filter-start-date">
                        </div>
                        <div class="form-group">
                            <label for="filter-end-date">Date de fin</label>
                            <input type="date" id="filter-end-date">
                        </div>
                            <div class="form-group">
                                <label for="filter-account">Compte</label>
                                <select id="filter-account">
                                    <option value="">Tous les comptes</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Type de D√©pense</label>
                                <div id="expense-type-checkboxes-container" style="border: 1px solid #ddd; border-radius: 4px; padding: 10px; background: white; max-height: 180px; overflow-y: auto;">
                                    <!-- Checkboxes will be dynamically generated -->
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="filter-category">Cat√©gorie</label>
                                <select id="filter-category">
                                    <option value="">Toutes les cat√©gories</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="filter-supplier">Fournisseur</label>
                                <input type="text" id="filter-supplier" placeholder="Rechercher par fournisseur...">
                            </div>
                            <div class="form-group">
                                <label for="filter-predictable">Pr√©visible</label>
                                <select id="filter-predictable">
                                    <option value="">Tous</option>
                                    <option value="oui">Oui</option>
                                    <option value="non">Non</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="filter-amount-min">Montant min (FCFA)</label>
                                <input type="number" id="filter-amount-min" placeholder="0" min="0">
                            </div>
                            <div class="form-group">
                                <label for="filter-amount-max">Montant max (FCFA)</label>
                                <input type="number" id="filter-amount-max" placeholder="Illimit√©" min="0">
                            </div>
                            <div class="form-group">
                                <label for="filter-user">Utilisateur</label>
                                <select id="filter-user">
                                    <option value="">Tous les utilisateurs</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-actions">
                            <button id="filter-expenses" class="btn btn-primary">
                                <i class="fas fa-filter"></i> Appliquer les filtres
                            </button>
                            <button id="clear-filters" class="btn btn-secondary">
                                <i class="fas fa-times"></i> Effacer les filtres
                            </button>
                            <button id="export-expenses" class="btn btn-success">
                                <i class="fas fa-download"></i> Exporter (CSV)
                            </button>
                        </div>
                    </div>
                    
                    <div class="invoice-management">
                        <div class="invoice-controls">
                            <button id="select-all-expenses" class="btn btn-secondary">
                                <i class="fas fa-check-square"></i> Tout s√©lectionner
                            </button>
                            <button id="deselect-all-expenses" class="btn btn-secondary">
                                <i class="fas fa-square"></i> Tout d√©s√©lectionner
                            </button>
                            <button id="generate-invoices" class="btn btn-success" disabled>
                                <i class="fas fa-file-pdf"></i> G√©rer factures
                            </button>
                            <span id="selected-count" class="selected-info">0 d√©pense(s) s√©lectionn√©e(s)</span>
                        </div>
                    </div>

                    <div class="table-container">
                        <div class="mobile-table-scroll">
                        <table id="expenses-table">
                            <thead>
                                <tr>
                                    <th>
                                        <input type="checkbox" id="select-all-header" title="S√©lectionner tout">
                                    </th>
                                    <th class="sortable" data-sort="expense_date">
                                        Date D√©pense <i class="fas fa-sort"></i>
                                    </th>
                                    <th class="sortable" data-sort="created_at">
                                        Timestamp <i class="fas fa-sort"></i>
                                    </th>
                                    <th class="sortable" data-sort="category_name">
                                        Cat√©gorie <i class="fas fa-sort"></i>
                                    </th>
                                    <th class="sortable" data-sort="designation">
                                        D√©signation <i class="fas fa-sort"></i>
                                    </th>
                                    <th class="sortable" data-sort="supplier">
                                        Fournisseur <i class="fas fa-sort"></i>
                                    </th>
                                    <th class="sortable" data-sort="quantity">
                                        Qt√© <i class="fas fa-sort"></i>
                                    </th>
                                    <th class="sortable" data-sort="unit_price">
                                        P.U. <i class="fas fa-sort"></i>
                                    </th>
                                    <th class="sortable" data-sort="total">
                                        Montant Total <i class="fas fa-sort"></i>
                                    </th>
                                    <th>Description</th>
                                    <th class="sortable" data-sort="predictable">
                                        Pr√©visible <i class="fas fa-sort"></i>
                                    </th>
                                    <th>Justificatif</th>
                                    <th class="sortable" data-sort="account_name">
                                        Compte <i class="fas fa-sort"></i>
                                    </th>
                                    <th class="sortable" data-sort="username">
                                        Username <i class="fas fa-sort"></i>
                                    </th>
                                    <th id="user-column" style="display: none;" class="sortable" data-sort="user_name">
                                        Directeur <i class="fas fa-sort"></i>
                                    </th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="expenses-tbody">
                            </tbody>
                        </table>
                        </div>
                    </div>
                </section>



                <!-- Ajouter une d√©pense -->
                <section id="add-expense-section" class="section">
                    <h2>Ajouter une D√©pense</h2>
                    
                    <!-- Indicateur de validation des d√©penses -->
                    <div id="validation-status-info" class="validation-status-card">
                        <div class="validation-content">
                            <div class="validation-indicator">
                                <i id="validation-icon" class="fas fa-shield-alt"></i>
                                <span id="validation-message">Chargement du statut de validation...</span>
                            </div>
                            <small id="validation-details" class="validation-help">
                                V√©rification en cours...
                            </small>
                        </div>
                    </div>
                    
                    <!-- Affichage du solde pour les directeurs -->
                    <div id="balance-info" class="balance-card" style="display: none;">
                        <div class="balance-content">
                            <h3><i class="fas fa-wallet"></i> Mon Solde</h3>
                            <div class="balance-details">
                                <div class="balance-item">
                                    <span class="balance-label">Solde actuel :</span>
                                    <span class="balance-value" id="current-balance">0 FCFA</span>
                                    <input type="number" id="current-balance-input" style="display:none; width:120px; margin-left:8px;" min="0" step="1" />
                                </div>
                                <div class="balance-item">
                                    <span class="balance-label">Total cr√©dit√© :</span>
                                    <span class="balance-value" id="total-credited">0 FCFA</span>
                                </div>
                                <div class="balance-item">
                                    <span class="balance-label">D√©pens√© / Total :</span>
                                    <span class="balance-value" id="total-spent">0 FCFA</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <form id="expense-form" class="expense-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="expense-account">Compte</label>
                                <select id="expense-account" name="account_id" required>
                                    <option value="">S√©lectionner un compte</option>
                                </select>
                                <small id="account-type-info" class="form-help" style="font-size: 11px; color: #666; font-style: italic; display: none;"></small>
                            </div>
                            
                            <div class="form-group">
                                <label for="expense-type">Type de D√©pense</label>
                                <select id="expense-type" name="expense_type" required>
                                    <option value="">S√©lectionner un type</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="expense-category">Cat√©gorie</label>
                                <select id="expense-category" name="category" required disabled>
                                    <option value="">S√©lectionner d'abord un type</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="expense-subcategory">Sous-cat√©gorie</label>
                                <select id="expense-subcategory" name="subcategory" required disabled>
                                    <option value="">S√©lectionner d'abord une cat√©gorie</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Champ sp√©cial pour les r√©seaux sociaux -->
                        <div class="form-row" id="social-network-row" style="display: none;">
                            <div class="form-group">
                                <label for="social-network-detail">Pr√©ciser le r√©seau social</label>
                                <select id="social-network-detail" name="social_network_detail">
                                    <option value="">S√©lectionner un r√©seau</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="expense-date">Date</label>
                                <input type="date" id="expense-date" name="expense_date" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="expense-designation">D√©signation</label>
                                <input type="text" id="expense-designation" name="designation" required placeholder="Ex: Achat de mat√©riel, Service de transport...">
                            </div>
                            
                            <div class="form-group">
                                <label for="expense-supplier">Nom Fournisseur</label>
                                <input type="text" id="expense-supplier" name="supplier" placeholder="Nom du fournisseur ou prestataire">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="expense-quantity">Quantit√©</label>
                                <input type="number" id="expense-quantity" name="quantity" step="0.01" min="0" required value="1" placeholder="1">
                            </div>
                            
                            <div class="form-group">
                                <label for="expense-unit-price">Prix Unitaire (FCFA)</label>
                                <input type="number" id="expense-unit-price" name="unit_price" step="1" min="0" required placeholder="0">
                            </div>
                            
                            <div class="form-group">
                                <label for="expense-total">Montant Total (FCFA)</label>
                                <input type="number" id="expense-total" name="total" step="1" min="0" required placeholder="Calcul√© automatiquement">
                                <small class="form-help">Se calcule automatiquement ou saisissez manuellement</small>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="expense-predictable">Pr√©visible</label>
                                <select id="expense-predictable" name="predictable" required>
                                    <option value="">S√©lectionner</option>
                                <option value="oui" selected>Oui</option>
                                    <option value="non">Non</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="expense-justification">Justificatif (Optionnel)</label>
                                <div class="file-input-wrapper">
                                    <input type="file" id="expense-justification" name="justification" 
                                           accept=".jpg,.jpeg,.png,.pdf,.doc,.docx,.xls,.xlsx"
                                           title="Formats accept√©s: JPG, PNG, PDF, Word, Excel"
                                           style="display: none;">
                                    <button type="button" class="file-input-button" onclick="document.getElementById('expense-justification').click()">
                                        <i class="fas fa-upload"></i> Choisir un fichier
                                    </button>
                                    <span class="file-input-text" id="file-input-text">Aucun fichier s√©lectionn√©</span>
                                </div>
                                <small class="file-info">Formats: JPG, PNG, PDF, Word, Excel (Max: 5MB)</small>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="expense-description">Description/Commentaires</label>
                            <textarea id="expense-description" name="description" placeholder="Informations compl√©mentaires..."></textarea>
                        </div>
                        
                        <button type="submit" class="btn btn-primary">Ajouter la D√©pense</button>
                    </form>
                    
                    <!-- Formulaire d'ajustement (visible uniquement pour DG/PCA) -->
                    <div id="adjustment-form-container" class="adjustment-form-container" style="display: none;">
                        <div class="adjustment-form-card">
                            <h3><i class="fas fa-balance-scale"></i> Ajustement Comptable</h3>
                            <p class="form-description">Formulaire sp√©cial pour les ajustements comptables et corrections</p>
                            
                            <form id="adjustment-form" class="adjustment-form">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="adjustment-date">Date</label>
                                        <input type="date" id="adjustment-date" name="adjustment_date" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="adjustment-amount">Montant (FCFA)</label>
                                        <input type="number" id="adjustment-amount" name="adjustment_amount" step="1" min="0" required placeholder="0">
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="adjustment-comment">Commentaire / Justification</label>
                                        <textarea id="adjustment-comment" name="adjustment_comment" required placeholder="D√©crivez la raison de cet ajustement comptable..." rows="3"></textarea>
                                    </div>
                                </div>
                                
                                <div class="form-actions">
                                    <button type="submit" class="btn btn-warning">
                                        <i class="fas fa-plus"></i> Ajouter l'Ajustement
                                    </button>
                                    <button type="button" id="reset-adjustment-form" class="btn btn-secondary">
                                        <i class="fas fa-undo"></i> R√©initialiser
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>

                </section>

                <!-- Cr√©diter Compte (Directeurs avec permissions) -->
                <section id="credit-account-section" class="section">
                    <h2>Cr√©diter un Compte</h2>
                    
                    <div class="credit-form-card">
                        <form id="directorCreditForm" class="account-form" style="max-width: 600px; margin: 0 auto;">
                            <div class="form-group">
                                <label for="director-credit-account">Compte</label>
                                <select id="director-credit-account" required>
                                    <option value="">S√©lectionner un compte</option>
                                </select>
                                <small class="form-help" id="director-credit-help"></small>
                            </div>
                            
                            <div class="form-group">
                                <label for="director-credit-amount">Montant (FCFA)</label>
                                <!-- Allow negatives for statut accounts ‚Äì rely on JS/DB layer for final validation -->
                                <input type="number" id="director-credit-amount" step="1" required>
                                <small class="form-help" id="director-amount-help" style="display: none; color: #666;">
                                    ‚ö†Ô∏è Compte Statut : montants n√©gatifs autoris√©s (le montant remplace le solde existant)
                                </small>
                            </div>
                            
                            <div class="form-group">
                                <label for="director-credit-date">Date</label>
                                <input type="date" id="director-credit-date" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="director-credit-comment">Commentaire (optionnel)</label>
                            <textarea id="director-credit-comment" placeholder="Ex: Budget mensuel, remboursement..."></textarea>
                            </div>
                            
                            <div class="form-actions">
                                <button type="submit" class="btn btn-success">
                                    <i class="fas fa-credit-card"></i> Cr√©diter le Compte
                                </button>
                            </div>
                        </form>
                        
                        <div id="director-credit-notification" class="notification" style="display:none;"></div>
                        
                        <!-- Historique des cr√©dits du directeur -->
                        <div class="director-credit-history" style="margin-top: 30px;">
                            <h3>Mes Cr√©dits R√©cents</h3>
                            <div class="table-container">
                                <table id="director-credit-history-table">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Compte</th>
                                            <th>Montant</th>
                                            <th>Commentaire</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="director-credit-history-tbody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- G√©rer les comptes (Admin uniquement) -->
                <section id="manage-accounts-section" class="section">
                    <h2>G√©rer les Comptes</h2>
                    
                    <!-- Cr√©er un nouveau compte -->
                    <form class="account-form" id="createAccountForm">
                        <h3>Cr√©er/Assigner un Compte</h3>
                        
                        <!-- Nouveau champ pour le nom du compte -->
                        <div class="form-group">
                            <label>Nom du Compte</label>
                            <input type="text" id="accountName" placeholder="Ex: Compte Directeur Commercial, Budget Formation..." required>
                        </div>
                        
                        <!-- Nouveau champ pour le type de compte -->
                        <div class="form-group">
                            <label>Type de Compte</label>
                            <select id="accountType" onchange="handleAccountTypeChange()" required>
                                <option value="">S√©lectionner un type</option>
                                <!-- Les types seront charg√©s dynamiquement -->
                            </select>
                            <small class="form-help" id="accountTypeHelp">S√©lectionnez d'abord un type pour voir la description</small>
                        </div>
                        
                        <div class="form-group" id="userSelectGroup">
                            <label>Assigner √† l'utilisateur</label>
                            <select id="createDirectorSelect" onchange="handleUserAssignmentChange()">
                                <option value="">S√©lectionner un utilisateur directeur</option>
                            </select>
                        </div>
                        
                        <!-- Nouveau champ pour le type de cat√©gorie (pour comptes classiques) -->
                        <div class="form-group" id="categoryTypeGroup" style="display: none;">
                            <label>Type de Cat√©gorie de D√©penses</label>
                            <select id="categoryTypeSelect">
                                <option value="">S√©lectionner un type de cat√©gorie</option>
                            </select>
                            <small class="form-help">Optionnel: Restreint les types de d√©penses pour ce compte.</small>
                        </div>
                        
                        <!-- Nouveau champ pour la permission de cr√©dit (pour comptes classiques) -->
                        <div class="form-group" id="creditPermissionGroup" style="display: none;">
                            <label>Donner la Permission de Cr√©dit √† (Optionnel)</label>
                            <select id="creditPermissionDirectorSelect">
                                <option value="">Aucun directeur suppl√©mentaire</option>
                            </select>
                            <small class="form-help">Permet √† un directeur de cr√©diter ce compte en plus du DG/PCA.</small>
                        </div>

                        <!-- Section pour l'assignation des directeurs partenaires -->
                        <div class="form-group" id="partnerDirectorsGroup" style="display: none;">
                            <label>Directeurs Assign√©s (Optionnel)</label>
                            <div class="directors-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                <div class="director-field">
                                    <label class="field-label">
                                        <i class="fas fa-user-tie me-2"></i>
                                        Directeur Principal
                                    </label>
                                    <select id="partnerDirector1" class="form-select">
                                        <option value="">S√©lectionner un directeur</option>
                                    </select>
                                </div>
                                <div class="director-field">
                                    <label class="field-label">
                                        <i class="fas fa-user-friends me-2"></i>
                                        Directeur Secondaire
                                    </label>
                                    <select id="partnerDirector2" class="form-select">
                                        <option value="">S√©lectionner un directeur</option>
                                    </select>
                                </div>
                            </div>
                            <small class="form-help">Assignez jusqu'√† 2 directeurs pour la gestion et validation des livraisons.</small>
                        </div>

                        <!-- Section pour afficher/g√©rer les permissions (pour la modification) -->
                        <div id="permissionsSection" style="display: none;">
                            <div id="creditPermissionsContainer"></div>
                        </div>
                        
                        <div class="form-group">
                            <label id="initialAmountLabel" for="initialAmount">Solde Actuel (lecture seule)</label>
                            <input type="number" id="initialAmount" name="initial_amount" step="0.01" placeholder="Solde n√©gatif ou positif" />
                        </div>
                        
                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="createDescription" placeholder="Ex: Nouveau compte pour..."></textarea>
                        </div>
                        
                        <div class="form-actions">
                        <button type="submit" class="btn btn-success">Cr√©er le Compte</button>
                            <button type="button" class="btn btn-secondary" id="cancelAccountEdit" onclick="resetAccountForm()" style="display: none; margin-left: 10px;">Annuler</button>
                        </div>
                    </form>

                    <form class="account-form" id="creditAccountForm">
                        <h3>Cr√©diter un Compte Existant</h3>
                        
                        <div class="form-group">
                            <label>Compte</label>
                            <select id="creditAccountSelect" onchange="handleCreditAccountChange()" required>
                                <option value="">S√©lectionner un compte</option>
                            </select>
                            <small class="form-help" id="creditAccountHelp"></small>
                        </div>
                        
                        <div class="form-group">
                            <label>Montant (FCFA)</label>
                            <!-- Allow negatives for statut accounts ‚Äì rely on JS/DB layer for final validation -->
                            <input type="number" id="creditAmount" step="1" required>
                            <small class="form-help" id="credit-amount-help" style="display: none; color: #666;">
                                ‚ö†Ô∏è Compte Statut : montants n√©gatifs autoris√©s (le montant remplace le solde existant)
                            </small>
                        </div>
                        
                        <div class="form-group">
                            <label>Date</label>
                            <input type="date" id="creditDate" required>
                        </div>
                        
                        <div class="form-group">
                            <label>Commentaire (optionnel)</label>
                            <textarea id="creditDescription" placeholder="Ex: Budget mensuel, remboursement..."></textarea>
                        </div>
                        
                        <div id="creditWarning" class="warning-message" style="display: none;">
                            <strong>Attention:</strong> <span id="creditWarningText"></span>
                        </div>
                        
                        <button type="submit" class="btn btn-primary" id="creditButton">Cr√©diter le Compte</button>
                    </form>

                    <div class="accounts-list">
                        <h3>Utilisateurs et Comptes Existants</h3>
                        <div id="accounts-list">
                            <!-- Les comptes seront charg√©s ici -->
                        </div>
                    </div>

                    <div class="credit-history">
                        <h3>Historique des Cr√©dits</h3>
                        
                        <!-- Filtres -->
                        <div class="credit-filters">
                            <div class="filter-group">
                                <label for="credit-account-filter">Filtrer par compte</label>
                                <select id="credit-account-filter" class="form-control">
                                    <option value="">Tous les comptes</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label for="credit-type-filter">Filtrer par type</label>
                                <select id="credit-type-filter" class="form-control">
                                    <option value="">Tous les types</option>
                                    <option value="CR√âDIT R√âGULIER">Cr√©dit R√©gulier</option>
                                    <option value="CR√âDIT SP√âCIAL">Cr√©dit Sp√©cial</option>
                                    <option value="CR√âDIT STATUT">Cr√©dit Statut</option>
                                    <option value="CR√âDIT CR√âANCE">Cr√©dit Cr√©ance</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <button id="clear-credit-filters" class="btn btn-secondary">
                                    <i class="fas fa-times"></i> Effacer les filtres
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table id="credit-history-table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Compte</th>
                                        <th>Type</th>
                                        <th>Montant</th>
                                        <th>Cr√©dit√© par</th>
                                        <th>Actions</th>
                                        <th>Supprimer</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody id="credit-history-tbody">
                                </tbody>
                            </table>
                        </div>
                        <div id="credit-pagination" class="mt-3">
                            <!-- La pagination sera g√©n√©r√©e ici -->
                        </div>
                    </div>
                </section>

                <!-- Suivi Comptes Partenaires -->
                <section id="partner-tracking-section" class="section">
                    <!-- Bouton de retour en haut (masqu√© par d√©faut) -->
                    <div class="partner-back-button" style="display: none;">
                        <button type="button" class="btn-back" onclick="closePartnerDetails()" title="Retour au r√©sum√©">
                            <i class="fas fa-arrow-left"></i> Retour au r√©sum√©
                        </button>
                    </div>
                    
                    <h2>Suivi des Comptes Partenaires</h2>
                    
                    <!-- R√©sum√© des comptes partenaires -->
                    <div class="partner-summary">
                        <div class="table-container">
                            <table id="partner-summary-table">
                                <thead>
                                    <tr>
                                        <th>Compte</th>
                                        <th>Montant Total</th>
                                        <th>Livr√©</th>
                                        <th>Restant</th>
                                        <th>Livraisons</th>
                                        <th>Articles</th>
                                        <th>Progression</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="partner-summary-tbody">
                                    <!-- Les donn√©es seront charg√©es ici -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Section des d√©tails d'un compte partenaire -->
                    <div id="partner-details" style="display: none;">
                        <h3 id="partner-details-title">D√©tails - Compte Partenaire</h3>
                        
                        <!-- Avertissement d'autorisation -->
                        <div id="delivery-authorization-warning" class="warning-message" style="display: none;">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span id="delivery-warning-text">Vous n'√™tes pas autoris√© √† ajouter des livraisons √† ce compte.</span>
                        </div>
                        
                        <!-- Formulaire d'ajout de livraison -->
                        <div class="account-form">
                            <h4><i class="fas fa-truck"></i> Ajouter une Livraison</h4>
                            <form id="addDeliveryForm">
                                <input type="hidden" id="delivery-account-id">
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="delivery-date">Date de Livraison</label>
                                        <input type="date" id="delivery-date" name="delivery_date" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="delivery-article-count">Nombre d'Articles</label>
                                        <input type="number" id="delivery-article-count" name="article_count" min="0" step="0.01" required placeholder="Ex: 50 ou 25.75">
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="delivery-unit-price">Prix Unitaire (FCFA)</label>
                                        <input type="number" id="delivery-unit-price" name="unit_price" min="0" step="1" placeholder="Ex: 2000">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="delivery-amount">Montant Total (FCFA)</label>
                                        <input type="number" id="delivery-amount" name="amount" min="1" step="1" required placeholder="Auto-calcul√© ou saisir manuellement">
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="delivery-description">Description</label>
                                    <textarea id="delivery-description" name="description" placeholder="Description des articles livr√©s..." rows="3"></textarea>
                                </div>
                                
                                <div class="form-actions">
                                    <button type="submit" id="add-delivery-btn" class="btn btn-success">
                                        <i class="fas fa-plus"></i> Ajouter la Livraison
                                    </button>
                                </div>
                            </form>
                        </div>
                        
                        <!-- Liste des livraisons -->
                        <div class="accounts-list">
                            <div class="deliveries-header">
                                <h3><i class="fas fa-truck"></i> Historique des Livraisons</h3>
                                <p class="header-description">Suivi et gestion des livraisons partenaires</p>
                            </div>
                            <div class="table-container">
                                <table id="deliveries-table">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Articles</th>
                                            <th>Prix Unit. √ó Qt√©</th>
                                            <th>Montant</th>
                                            <th>Description</th>
                                            <th>Cr√©√© par</th>
                                            <th>Statut</th>
                                            <th class="validation-column">
                                                <i class="fas fa-check-circle"></i>
                                                <span class="validation-label">Validation</span>
                                            </th>
                                            <th class="delete-column">
                                                <i class="fas fa-trash-alt"></i>
                                                <span class="delete-label">Suppr.</span>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="deliveries-tbody">
                                        <!-- Les livraisons seront charg√©es ici -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Section Gestion Cr√©ances -->
                <section id="creance-section" class="section">
                    <h2><i class="fas fa-money-check-alt"></i> Gestion des Cr√©ances</h2>
                    <p class="section-description">Suivi des cr√©ances clients par compte</p>

                    <!-- S√©lection du compte cr√©ance -->
                    <div class="creance-account-selector">
                        <div class="form-group">
                            <label for="creance-account-select">S√©lectionner un compte cr√©ance</label>
                            <select id="creance-account-select" class="form-control">
                                <option value="">Choisir un compte cr√©ance...</option>
                            </select>
                        </div>
                    </div>

                    <!-- Zone principale - masqu√©e jusqu'√† s√©lection d'un compte -->
                    <div id="creance-main-content" style="display: none;">
                        <!-- En-t√™te du compte s√©lectionn√© -->
                        <div class="creance-account-header">
                            <h3 id="creance-account-title">Compte : [Nom du compte]</h3>
                            <p id="creance-account-director">Directeur assign√© : [Nom du directeur]</p>
                        </div>

                        <!-- Op√©rations cr√©ance (Tous les utilisateurs autoris√©s) -->
                        <div id="creance-operations-section" class="creance-section">
                            <div class="section-card">
                                <h4><i class="fas fa-exchange-alt"></i> Op√©rations Cr√©ance</h4>
                                
                                <!-- Formulaire d'ajout d'op√©ration -->
                                <div class="add-operation-form">
                                    <h5>Nouvelle op√©ration</h5>
                                    <form id="add-operation-form">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label for="operation-client">Client *</label>
                                                <select id="operation-client" name="operation-client" required>
                                                    <option value="">S√©lectionner un client...</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label for="operation-type">Type d'op√©ration *</label>
                                                <select id="operation-type" name="operation-type" required>
                                                    <option value="">S√©lectionner...</option>
                                                    <option value="credit">Avance (+)</option>
                                                    <option value="debit">Remboursement (-)</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label for="operation-amount">Montant (FCFA) *</label>
                                                <input type="number" id="operation-amount" name="operation-amount" min="1" required placeholder="Montant en FCFA">
                                            </div>
                                            <div class="form-group">
                                                <label for="operation-date">Date *</label>
                                                <input type="date" id="operation-date" name="operation-date" required>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="operation-description">Description</label>
                                            <input type="text" id="operation-description" name="operation-description" placeholder="Description de l'op√©ration">
                                        </div>
                                        <div class="form-actions">
                                            <button type="submit" class="btn btn-primary">
                                                <i class="fas fa-plus"></i> Enregistrer l'op√©ration
                                            </button>
                                            <button type="button" class="btn btn-secondary" id="cancel-operation-edit" onclick="cancelOperationEdit()" style="display: none;">
                                                <i class="fas fa-times"></i> Annuler
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <!-- Gestion des clients (Admin/DG/PCA uniquement) -->
                        <div id="creance-admin-section" class="creance-section" style="display: none;">
                            <div class="section-card">
                                <h4><i class="fas fa-users"></i> Gestion des Clients</h4>
                                
                                <!-- Formulaire d'ajout de client -->
                                <div class="add-client-form">
                                    <h5>Ajouter un nouveau client</h5>
                                    <form id="add-client-form">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label for="client-name">Nom du client *</label>
                                                <input type="text" id="client-name" name="client-name" required placeholder="Nom complet du client">
                                            </div>
                                            <div class="form-group">
                                                <label for="client-phone">T√©l√©phone</label>
                                                <input type="text" id="client-phone" name="client-phone" placeholder="Num√©ro de t√©l√©phone">
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label for="client-address">Adresse</label>
                                                <input type="text" id="client-address" name="client-address" placeholder="Adresse du client">
                                            </div>
                                            <div class="form-group">
                                                <label for="initial-credit">Cr√©dit initial (FCFA)</label>
                                                <input type="number" id="initial-credit" name="initial-credit" min="0" value="0" placeholder="0">
                                            </div>
                                        </div>
                                        <button type="submit" class="btn btn-success">
                                            <i class="fas fa-plus"></i> Ajouter le client
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <!-- Tableau r√©capitulatif par client -->
                        <div class="creance-summary-section">
                            <div class="section-card">
                                <h4><i class="fas fa-table"></i> R√©capitulatif par Client</h4>
                                
                                <!-- Ajout des filtres -->
                                <div class="filters-container" style="margin-bottom: 15px; display: flex; gap: 10px;">
                                    <div class="filter-group" style="flex: 1;">
                                        <input type="text" id="client-filter" class="form-control" placeholder="Filtrer par client...">
                                    </div>
                                    <div class="filter-group" style="flex: 1;">
                                        <input type="text" id="phone-filter" class="form-control" placeholder="Filtrer par t√©l√©phone...">
                                    </div>
                                </div>

                                <div class="table-container">
                                    <table id="clients-summary-table" class="data-table">
                                        <thead>
                                            <tr>
                                                <th>Client</th>
                                                <th>T√©l√©phone</th>
                                                <th>Cr√©dit Initial</th>
                                                <th>Total Avances</th>
                                                <th>Total Remboursements</th>
                                                <th>Solde Final</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="clients-summary-tbody">
                                            <!-- Les donn√©es seront charg√©es ici -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Historique des op√©rations -->
                        <div class="creance-history-section">
                            <div class="section-card">
                                <h4><i class="fas fa-history"></i> Historique des Op√©rations</h4>
                                
                                <div class="table-container">
                                    <table id="operations-history-table" class="data-table">
                                        <thead>
                                            <tr>
                                                <th>Date Op√©ration</th>
                                                <th>Timestamp</th>
                                                <th>Client</th>
                                                <th>Type</th>
                                                <th>Montant</th>
                                                <th>Description</th>
                                                <th>Cr√©√© par</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="operations-history-tbody">
                                            <!-- L'historique sera charg√© ici -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Section Cash Bictorys Mois -->
                <section id="cash-bictorys-section" class="section">
                    <h2><i class="fas fa-money-bill-wave"></i> Cash Bictorys Mois</h2>
                    <p class="section-description">Suivi quotidien des valeurs Cash Bictorys par mois</p>

                    <!-- S√©lection du mois -->
                    <div class="cash-bictorys-controls">
                        <div class="form-group">
                            <label for="cash-bictorys-month">S√©lectionner le mois</label>
                            <input type="month" id="cash-bictorys-month" class="form-control">
                        </div>
                        <div class="form-actions">
                            <button id="load-cash-bictorys-btn" class="btn btn-primary">
                                <i class="fas fa-calendar-alt"></i> Charger le mois
                            </button>
                            <button id="save-cash-bictorys-btn" class="btn btn-success" disabled>
                                <i class="fas fa-save"></i> Sauvegarder
                            </button>
                        </div>
                    </div>

                    <!-- Zone principale - masqu√©e jusqu'√† s√©lection d'un mois -->
                    <div id="cash-bictorys-main-content" style="display: none;">
                        <!-- En-t√™te du mois s√©lectionn√© -->
                        <div class="cash-bictorys-header">
                            <h3 id="cash-bictorys-month-title">Mois : [Nom du mois]</h3>
                                                    <div class="month-totals">
                            <div class="month-total">
                                <span class="total-label">Derni√®re valeur :</span>
                                <span id="cash-bictorys-total" class="total-value">0 FCFA</span>
                            </div>
                            <div class="month-total">
                                <span class="total-label">Balance :</span>
                                <span id="cash-bictorys-balance" class="total-value">0 FCFA</span>
                            </div>
                            <div class="month-total">
                                <span class="total-label">Frais :</span>
                                <span id="cash-bictorys-fees" class="total-value">0 FCFA</span>
                            </div>
                        </div>
                        </div>

                        <!-- Permissions d'√©dition -->
                        <div id="cash-bictorys-permissions-info" class="permissions-info">
                            <i class="fas fa-info-circle"></i>
                            <span id="permissions-text">Chargement des permissions...</span>
                        </div>

                        <!-- Tableau des valeurs quotidiennes -->
                        <div class="cash-bictorys-table-section">
                            <div class="section-card">
                                <h4><i class="fas fa-table"></i> Valeurs Quotidiennes</h4>
                                
                                <div class="table-container">
                                    <table id="cash-bictorys-table" class="data-table">
                                        <thead>
                                            <tr>
                                                <th>Date</th>
                                                <th>Jour</th>
                                                <th>Valeur (FCFA)</th>
                                                <th>Balance (FCFA)</th>
                                                <th>Frais (FCFA)</th>
                                            </tr>
                                        </thead>
                                        <tbody id="cash-bictorys-tbody">
                                            <!-- Les donn√©es seront charg√©es ici -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <style>
                /* Styles sp√©cifiques pour Cash Bictorys */
                .cash-bictorys-controls {
                    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
                    border-radius: 12px;
                    padding: 20px;
                    margin-bottom: 20px;
                    display: flex;
                    align-items: end;
                    gap: 20px;
                    flex-wrap: wrap;
                }
                
                .cash-bictorys-header {
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    border-radius: 12px;
                    padding: 20px;
                    margin-bottom: 20px;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    flex-wrap: wrap;
                }
                
                .cash-bictorys-header h3 {
                    margin: 0;
                    font-size: 1.4em;
                }
                
                .month-totals {
                    display: flex;
                    gap: 20px;
                    flex-wrap: wrap;
                }

                .month-total {
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    min-width: 200px;
                }
                
                .total-label {
                    font-weight: 500;
                    opacity: 0.9;
                    white-space: nowrap;
                }
                
                .total-value {
                    font-size: 1.2em;
                    font-weight: bold;
                    padding: 8px 16px;
                    background: rgba(255, 255, 255, 0.2);
                    border-radius: 8px;
                    min-width: 120px;
                    text-align: right;
                }
                
                .permissions-info {
                    background: #e3f2fd;
                    border: 1px solid #bbdefb;
                    border-radius: 8px;
                    padding: 12px;
                    margin-bottom: 20px;
                    color: #1976d2;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                }
                
                .cash-amount-input {
                    width: 120px;
                    padding: 6px 8px;
                    border: 1px solid #ddd;
                    border-radius: 4px;
                    text-align: right;
                    font-family: monospace;
                }
                
                .cash-amount-input:focus {
                    outline: none;
                    border-color: #667eea;
                    box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
                }
                
                .amount-display {
                    font-family: monospace;
                    font-weight: 500;
                    min-width: 100px;
                    display: inline-block;
                }
                
                .day-name {
                    text-transform: capitalize;
                    font-weight: 500;
                }
                
                .day-name.weekend {
                    color: #f44336;
                    font-weight: bold;
                }
                
                .weekend-row {
                    background-color: #fff8e1;
                }
                
                .amount-cell {
                    text-align: right;
                    min-width: 120px;
                }

                .amount-cell input {
                    width: 100%;
                }

                .amount-positive {
                    color: #2f855a;
                }

                .amount-negative {
                    color: #c53030;
                }

                .amount-neutral {
                    color: #4a5568;
                }
                
                .btn-disabled {
                    opacity: 0.5;
                    cursor: not-allowed;
                }
                
                @media (max-width: 768px) {
                    .cash-bictorys-controls {
                        flex-direction: column;
                        align-items: stretch;
                    }
                    
                    .cash-bictorys-header {
                        flex-direction: column;
                        gap: 15px;
                        text-align: center;
                    }

                    .month-totals {
                        flex-direction: column;
                        gap: 10px;
                        width: 100%;
                    }

                    .month-total {
                        width: 100%;
                        justify-content: space-between;
                        min-width: unset;
                    }
                    
                    .cash-amount-input {
                        width: 100px;
                    }

                    .amount-cell {
                        min-width: 100px;
                    }

                    .amount-display {
                        min-width: 80px;
                    }

                    .table-container {
                        overflow-x: auto;
                        -webkit-overflow-scrolling: touch;
                    }

                    #cash-bictorys-table {
                        min-width: 800px;
                    }
                }
                </style>

                <!-- Section Montant D√©but de Mois -->
                <section id="montant-debut-mois-section" class="section">
                    <h2><i class="fas fa-calendar-alt"></i> Montant D√©but de Mois</h2>
                    <p class="section-description">G√©rez les montants de d√©but de mois pour chaque portefeuille classique</p>

                    <!-- S√©lection de la p√©riode -->
                    <div class="montant-debut-controls">
                        <div class="form-group">
                            <label for="montant-debut-month">S√©lectionner le mois</label>
                            <input type="month" id="montant-debut-month" class="form-control">
                        </div>
                        <div class="form-actions">
                            <button id="load-montant-debut-btn" class="btn btn-primary">
                                <i class="fas fa-search"></i> Charger les donn√©es
                            </button>
                            <button id="save-montant-debut-btn" class="btn btn-success" disabled>
                                <i class="fas fa-save"></i> Sauvegarder
                            </button>
                        </div>
                    </div>

                    <!-- Zone principale - masqu√©e jusqu'√† s√©lection d'un mois -->
                    <div id="montant-debut-main-content" style="display: none;">
                        <!-- En-t√™te du mois s√©lectionn√© -->
                        <div class="montant-debut-header">
                            <h3 id="montant-debut-month-title">Mois : [Nom du mois]</h3>
                            <div class="month-summary">
                                <div class="summary-stat">
                                    <span class="stat-label">Portefeuilles configur√©s :</span>
                                    <span id="montant-debut-configured-count" class="stat-value">0</span>
                                </div>
                                <div class="summary-stat">
                                    <span class="stat-label">Total montants :</span>
                                    <span id="montant-debut-total" class="stat-value">0 FCFA</span>
                                </div>
                            </div>
                        </div>

                        <!-- Permissions d'√©dition -->
                        <div id="montant-debut-permissions-info" class="permissions-info">
                            <i class="fas fa-info-circle"></i>
                            <span id="montant-debut-permissions-text">Acc√®s r√©serv√© aux Directeurs G√©n√©raux, PCA et Administrateurs</span>
                        </div>

                        <!-- Tableau des portefeuilles classiques -->
                        <div class="montant-debut-table-section">
                            <div class="section-card">
                                <h4><i class="fas fa-wallet"></i> Portefeuilles Classiques</h4>
                                
                                <div class="table-container">
                                    <table id="montant-debut-table" class="data-table">
                                        <thead>
                                            <tr>
                                                <th>Portefeuille</th>
                                                <th>Propri√©taire</th>
                                                <th>Montant D√©but de Mois (FCFA)</th>
                                                <th>Derni√®re Modification</th>
                                            </tr>
                                        </thead>
                                        <tbody id="montant-debut-tbody">
                                            <!-- Les donn√©es seront charg√©es ici -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <style>
                /* Styles sp√©cifiques pour Montant D√©but de Mois */
                .montant-debut-controls {
                    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
                    border-radius: 12px;
                    padding: 20px;
                    margin-bottom: 20px;
                    display: flex;
                    align-items: end;
                    gap: 20px;
                    flex-wrap: wrap;
                }
                
                .montant-debut-header {
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    border-radius: 12px;
                    padding: 20px;
                    margin-bottom: 20px;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    flex-wrap: wrap;
                }
                
                .montant-debut-header h3 {
                    margin: 0;
                    font-size: 1.4em;
                }
                
                .month-summary {
                    display: flex;
                    gap: 20px;
                    flex-wrap: wrap;
                }

                .summary-stat {
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    min-width: 200px;
                }
                
                .stat-label {
                    font-weight: 500;
                    opacity: 0.9;
                    white-space: nowrap;
                }
                
                .stat-value {
                    font-size: 1.2em;
                    font-weight: bold;
                    padding: 8px 16px;
                    background: rgba(255, 255, 255, 0.2);
                    border-radius: 8px;
                    min-width: 120px;
                    text-align: right;
                }
                
                .montant-debut-input {
                    width: 150px;
                    padding: 8px 12px;
                    border: 1px solid #ddd;
                    border-radius: 6px;
                    text-align: right;
                    font-family: monospace;
                    font-size: 14px;
                }
                
                .montant-debut-input:focus {
                    outline: none;
                    border-color: #667eea;
                    box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
                }
                
                .montant-debut-input:invalid {
                    border-color: #e53e3e;
                    box-shadow: 0 0 0 2px rgba(229, 62, 62, 0.2);
                }
                
                .montant-display {
                    font-family: monospace;
                    font-weight: 500;
                    min-width: 120px;
                    display: inline-block;
                    text-align: right;
                }
                
                .montant-positive {
                    color: #000000;
                }

                .montant-negative {
                    color: #c53030;
                }

                .montant-neutral {
                    color: #4a5568;
                }
                
                .wallet-name {
                    font-weight: 600;
                    color: #2d3748;
                }
                
                .owner-name {
                    color: #4a5568;
                    font-style: italic;
                }
                
                .last-modified {
                    color: #718096;
                    font-size: 0.9em;
                }
                
                .montant-debut-table-section .section-card {
                    background: white;
                    border-radius: 12px;
                    padding: 20px;
                    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
                }
                
                @media (max-width: 768px) {
                    .montant-debut-controls {
                        flex-direction: column;
                        align-items: stretch;
                    }
                    
                    .montant-debut-header {
                        flex-direction: column;
                        gap: 15px;
                        text-align: center;
                    }

                    .month-summary {
                        flex-direction: column;
                        gap: 10px;
                        width: 100%;
                    }

                    .summary-stat {
                        width: 100%;
                        justify-content: space-between;
                        min-width: unset;
                    }
                    
                    .montant-debut-input {
                        width: 120px;
                    }

                    .table-container {
                        overflow-x: auto;
                        -webkit-overflow-scrolling: touch;
                    }

                    #montant-debut-table {
                        min-width: 700px;
                    }
                }
                </style>

                <!-- G√©rer les utilisateurs (Admin uniquement) -->
                <section id="manage-users-section" class="section">
                    <h2>G√©rer les Utilisateurs</h2>
                    
                    <!-- Cr√©er un nouvel utilisateur -->
                    <form class="account-form" id="createUserForm">
                        <h3>Cr√©er un Nouvel Utilisateur</h3>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>Nom d'utilisateur</label>
                                <input type="text" id="newUsername" placeholder="Ex: jdupont" autocomplete="username" required>
                                <small class="form-help">Utilis√© pour la connexion (sans espaces)</small>
                            </div>
                            
                            <div class="form-group">
                                <label>Nom complet</label>
                                <input type="text" id="newFullName" placeholder="Ex: Jean Dupont" autocomplete="name" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>Email (optionnel)</label>
                                <input type="email" id="newEmail" placeholder="jean.dupont@example.com" autocomplete="email">
                            </div>
                            
                            <div class="form-group">
                                <label>R√¥le</label>
                                <select id="newUserRole" required>
                                    <option value="">S√©lectionner un r√¥le</option>
                                    <option value="directeur">Directeur</option>
                                    <option value="directeur_general">Directeur G√©n√©ral</option>
                                    <option value="pca">PCA</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Mot de passe temporaire</label>
                            <input type="password" id="newPassword" placeholder="Mot de passe temporaire" autocomplete="new-password" required>
                            <small class="form-help">L'utilisateur devra changer ce mot de passe √† sa premi√®re connexion</small>
                        </div>
                        
                        <div class="form-actions">
                            <button type="submit" class="btn btn-success">Cr√©er l'Utilisateur</button>
                            <button type="button" class="btn btn-secondary" id="cancelUserEdit" onclick="resetUserForm()" style="display: none; margin-left: 10px;">Annuler</button>
                        </div>
                    </form>

                    <!-- Liste des utilisateurs existants -->
                    <div class="users-list-section">
                        <h3>Utilisateurs Existants</h3>
                        
                        <!-- Filtres -->
                        <div class="user-filters">
                            <h4>Filtres</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Filtrer par Statut</label>
                                    <select id="statusFilter" onchange="filterUsers()">
                                        <option value="">Tous les statuts</option>
                                        <option value="active">Actifs uniquement</option>
                                        <option value="inactive">Inactifs uniquement</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label>Filtrer par R√¥le</label>
                                    <select id="roleFilter" onchange="filterUsers()">
                                        <option value="">Tous les r√¥les</option>
                                        <option value="directeur">Directeur</option>
                                        <option value="directeur_general">Directeur G√©n√©ral</option>
                                        <option value="pca">PCA</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <button type="button" class="btn" onclick="clearUserFilters()">
                                        Effacer les filtres
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div id="users-list">
                            <!-- Les utilisateurs seront charg√©s ici -->
                        </div>
                    </div>

                    <!-- Configuration des directeurs partenaires -->
                    <div class="users-list-section">
                        <h3>Configuration des Directeurs Partenaires</h3>
                        <div id="partner-accounts-config">
                            <!-- Configuration sera charg√©e ici -->
                        </div>
                    </div>
                </section>

                <!-- Section Remboursements -->
               <!-- <section id="remboursements-section" class="section">
                    <h2>Remboursements / Dettes Clients</h2>
                    <div class="remboursement-form-card">
                        <h3>Nouvelle op√©ration</h3>
                        <form id="remboursement-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="remb-nom-client">Nom du client</label>
                                    <input type="text" id="remb-nom-client" name="nom_client" required>
                                </div>
                                <div class="form-group">
                                    <label for="remb-numero-tel">Num√©ro de t√©l√©phone (unique)</label>
                                    <input type="text" id="remb-numero-tel" name="numero_tel" required>
                                </div>
                                <div class="form-group">
                                    <label for="remb-date">Date</label>
                                    <input type="date" id="remb-date" name="date" required>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="remb-action">Action</label>
                                    <select id="remb-action" name="action" required>
                                        <option value="">S√©lectionner</option>
                                        <option value="remboursement">Remboursement</option>
                                        <option value="dette">Dette</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="remb-montant">Montant (FCFA)</label>
                                    <input type="number" id="remb-montant" name="montant" min="1" required>
                                </div>
                                <div class="form-group">
                                    <label for="remb-commentaire">Commentaire</label>
                                    <input type="text" id="remb-commentaire" name="commentaire">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary">Ajouter</button>
                        </form>
                        <div id="remboursement-form-message" class="form-message"></div>
                    </div>
                    <div class="remboursement-synthese-card">
                        <h3>Synth√®se par client</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="synthese-date-debut">Date d√©but</label>
                                <input type="date" id="synthese-date-debut">
                            </div>
                            <div class="form-group">
                                <label for="synthese-date-fin">Date fin</label>
                                <input type="date" id="synthese-date-fin">
                            </div>
                            <button id="synthese-filtrer" class="btn btn-secondary">Filtrer</button>
                        </div>
                        <div class="table-container">
                            <table id="synthese-table">
                                <thead>
                                    <tr>
                                        <th>Nom du client</th>
                                        <th>Num√©ro</th>
                                        <th>Total (+remboursement -dette)</th>
                                        <th>Date dernier paiement</th>
                                    </tr>
                                </thead>
                                <tbody id="synthese-tbody"></tbody>
                            </table>
                        </div>
                    </div>
                </section>-->

                <!-- Section Gestion Stock -->
                <section id="stock-soir-section" class="section">
                    <h2 style="color: #22c55e;">Gestion des Stocks du Soir</h2>
                    
                    <!-- Upload de fichier JSON -->
                    <div class="stock-upload-card" style="display: none;">
                        <h3><i class="fas fa-upload"></i> Importer un fichier de r√©conciliation</h3>
                        <form id="stock-upload-form" enctype="multipart/form-data">
                            <div class="form-group">
                                <label for="reconciliation-file">Fichier JSON de r√©conciliation</label>
                                <input type="file" id="reconciliation-file" name="reconciliation" accept=".json,application/json" required>
                                <small class="form-help">S√©lectionnez un fichier JSON avec la structure de r√©conciliation</small>
                            </div>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-upload"></i> Importer les donn√©es
                            </button>
                        </form>
                        <div id="upload-result" class="form-message"></div>
                    </div>

                    <!-- Filtres et actions -->
                    <div class="stock-controls">
                        <div class="stock-filters">
                            <div class="form-group">
                                <label for="stock-date-filter">Date</label>
                                <input type="date" id="stock-date-filter" class="form-control" placeholder="S√©lectionner une date">
                            </div>
                            <div class="form-group">
                                <label for="stock-point-filter">Point de vente</label>
                                <select id="stock-point-filter">
                                    <option value="">Tous les points</option>
                                </select>
                            </div>
                            <button id="filter-stock" class="btn btn-secondary">
                                <i class="fas fa-filter"></i> Filtrer
                            </button>
                            <button id="refresh-stock" class="btn btn-secondary">
                                <i class="fas fa-sync-alt"></i> Actualiser
                            </button>
                        </div>
                        <div class="stock-actions">
                            <button id="add-stock-btn" class="btn btn-success">
                                <i class="fas fa-plus"></i> Ajouter
                            </button>
                            <button id="view-stats-btn" class="btn btn-info">
                                <i class="fas fa-chart-bar"></i> Statistiques
                            </button>
                        </div>
                    </div>

                    <!-- Affichage du total -->
                    <div id="stock-total-display" class="stock-total-display" style="display: none;">
                        <div class="total-card">
                            <h4><i class="fas fa-calculator"></i> Total Stock Soir</h4>
                            <div class="total-amount" id="stock-total-amount">0 FCFA</div>
                        </div>
                    </div>

                    <!-- Tableau des donn√©es de stock -->
                    <div class="table-container">
                        <table id="stock-table" class="data-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Point de Vente</th>
                                    <th>Produit</th>
                                    <th>Stock Matin</th>
                                    <th>Stock Soir</th>
                                    <th>Transfert</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="stock-tbody">
                                <!-- Les donn√©es seront charg√©es ici -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Statistiques par point de vente -->
                    <div id="stock-stats" class="stock-stats" style="display: none;">
                        <h3>Statistiques par Point de Vente</h3>
                        <div class="table-container">
                            <table id="stats-table" class="data-table">
                                <thead>
                                    <tr>
                                        <th>Point de Vente</th>
                                        <th>Nb Produits</th>
                                        <th>Total Stock Matin</th>
                                        <th>Total Stock Soir</th>
                                        <th>Total Transfert</th>
                                        <th>Total Ventes Th√©oriques</th>
                                    </tr>
                                </thead>
                                <tbody id="stats-tbody">
                                    <!-- Les statistiques seront charg√©es ici -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- Section Stock Vivant -->
                <section id="stock-vivant-section" class="section">
                    <div class="section-header">
                        <h2><i class="fas fa-seedling"></i> Stock Vivant</h2>
                        <p class="section-description">Gestion et suivi du stock vivant quotidien</p>
                    </div>

                    <!-- Filtres et contr√¥les -->
                    <div class="filters-container">
                        <div class="filters-row">
                            <div class="filter-group">
                                <label for="stock-vivant-date">Date du stock</label>
                                <input type="date" id="stock-vivant-date" class="form-control">
                            </div>
                            
                            <div class="filter-group" style="display: none;">
                                <label for="stock-vivant-mode">Mode d'affichage</label>
                                <select id="stock-vivant-mode" class="form-control">
                                    <option value="saisie">Saisie Simple</option>
                                    <option value="consultation">Consultation</option>
                                    <option value="historique">Historique</option>
                                </select>
                            </div>
                            
                            <div class="filter-group">
                                <label for="stock-vivant-category-filter">Cat√©gorie</label>
                                <select id="stock-vivant-category-filter" class="form-control">
                                    <option value="">Toutes les cat√©gories</option>
                                </select>
                            </div>
                            
                            <div class="filter-actions">
                                <button type="button" id="load-stock-data-btn" class="btn btn-primary">
                                    <i class="fas fa-search"></i> Charger
                                </button>
                                <button type="button" id="reset-stock-filters-btn" class="btn btn-secondary">
                                    <i class="fas fa-eraser"></i> R√©initialiser
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Zone de contenu principal -->
                    <div class="content-container">
                        <!-- Mode Saisie Simple -->
                        <div id="stock-vivant-saisie" class="stock-mode-panel">
                            <div class="panel-header">
                                <h3><i class="fas fa-edit"></i> Saisie du Stock</h3>
                                <div class="panel-actions">
                                    <button type="button" id="save-stock-btn" class="btn btn-success">
                                        <i class="fas fa-save"></i> Sauvegarder
                                    </button>
                                    <button type="button" id="copy-stock-btn" class="btn btn-info">
                                        <i class="fas fa-copy"></i> Copier depuis une date
                                    </button>
                                    <button type="button" id="clear-stock-btn" class="btn btn-warning">
                                        <i class="fas fa-eraser"></i> Effacer
                                    </button>
                                </div>
                            </div>
                            
                            <div class="table-responsive">
                                <div id="stock-vivant-simple-table">
                                    <!-- Le tableau sera g√©n√©r√© par JavaScript -->
                                </div>
                            </div>
                            
                            <div class="stock-summary">
                                <div class="summary-item">
                                    <label>Total G√©n√©ral:</label>
                                    <span id="stock-grand-total" class="total-value">0 FCFA</span>
                                </div>
                            </div>
                        </div>

                        <!-- Mode Consultation -->
                        <div id="stock-vivant-consultation" class="stock-mode-panel" style="display: none;">
                            <div class="panel-header">
                                <h3><i class="fas fa-eye"></i> Consultation du Stock</h3>
                                <div class="panel-actions">
                                    <button type="button" id="export-stock-btn" class="btn btn-info">
                                        <i class="fas fa-download"></i> Exporter
                                    </button>
                                </div>
                            </div>
                            
                            <div class="table-responsive">
                                <div id="stock-vivant-view-table">
                                    <!-- Les donn√©es de consultation seront affich√©es ici -->
                                </div>
                            </div>
                        </div>

                        <!-- Mode Historique -->
                        <div id="stock-vivant-historique" class="stock-mode-panel" style="display: none;">
                            <div class="panel-header">
                                <h3><i class="fas fa-history"></i> Historique du Stock</h3>
                                <div class="panel-info">
                                    <span id="stock-dates-info" class="info-text"></span>
                                </div>
                            </div>
                            
                            <div class="dates-selector">
                                <select id="stock-dates-select" class="form-control">
                                    <option value="">S√©lectionner une date</option>
                                </select>
                            </div>
                            
                            <div class="table-responsive">
                                <div id="stock-vivant-history-table">
                                    <!-- L'historique sera affich√© ici -->
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Section Admin Config -->
                <section id="admin-config-section" class="section">
                    <h2><i class="fas fa-cogs"></i> Configuration</h2>
                    <p class="section-description">G√©rer les fichiers de configuration du syst√®me</p>

                    <div class="config-tabs">
                        <div class="tab-buttons">
                            <button type="button" class="tab-button active" data-config="categories">
                                <i class="fas fa-tags"></i> Configuration Cat√©gories
                            </button>
                            <button type="button" class="tab-button" data-config="stock-vivant">
                                <i class="fas fa-seedling"></i> Configuration Stock Vivant
                            </button>
                            <button type="button" class="tab-button" data-config="financial">
                                 Param√®tres Financiers
                            </button>
                            <button type="button" class="tab-button" data-config="stock-permissions">
                                <i class="fas fa-user-check"></i> Permissions Stock Vivant
                            </button>
                        </div>

                        <!-- Configuration des Cat√©gories -->
                        <div id="categories-config" class="config-panel active">
                            <div class="config-header">
                                <h3><i class="fas fa-tags"></i> Configuration des Cat√©gories</h3>
                                <div class="config-actions">
                                    <button type="button" id="save-categories-config" class="btn btn-success" disabled>
                                        <i class="fas fa-save"></i> Sauvegarder
                                    </button>
                                    <button type="button" id="reload-categories-config" class="btn btn-secondary">
                                        <i class="fas fa-sync"></i> Recharger
                                    </button>
                                </div>
                            </div>
                            
                            <div class="config-editor">
                                <div class="form-group">
                                    <label for="categories-json-editor">Configuration JSON des Cat√©gories</label>
                                    
                                    <!-- Toolbar pour l'√©diteur -->
                                    <div class="json-toolbar">
                                        <div class="toolbar-group">
                                            <button type="button" class="btn btn-sm btn-tool" id="format-categories-json" title="Formater le JSON">
                                                <i class="fas fa-code"></i> Formater
                                            </button>
                                            <button type="button" class="btn btn-sm btn-tool" id="minify-categories-json" title="Minifier le JSON">
                                                <i class="fas fa-compress"></i> Minifier
                                            </button>
                                            <button type="button" class="btn btn-sm btn-tool" id="validate-categories-json" title="Valider le JSON">
                                                <i class="fas fa-check-circle"></i> Valider
                                            </button>
                                        </div>
                                        <div class="toolbar-group">
                                            <button type="button" class="btn btn-sm btn-tool" id="undo-categories" title="Annuler">
                                                <i class="fas fa-undo"></i>
                                            </button>
                                            <button type="button" class="btn btn-sm btn-tool" id="redo-categories" title="Refaire">
                                                <i class="fas fa-redo"></i>
                                            </button>
                                        </div>
                                        <div class="toolbar-info">
                                            <span class="line-info" id="categories-line-info">Ligne 1, Col 1</span>
                                        </div>
                                    </div>

                                    <div class="json-editor-container">
                                        <div class="json-line-numbers" id="categories-line-numbers">1</div>
                                        <textarea id="categories-json-editor" class="json-editor" rows="25" placeholder="Chargement de la configuration..."></textarea>
                                    </div>
                                    
                                    <div class="json-status" id="categories-json-status">
                                        <span class="status-indicator status-valid">
                                            <i class="fas fa-check-circle"></i> JSON valide
                                        </span>
                                    </div>
                                    
                                    <small class="form-help">
                                        <i class="fas fa-info-circle"></i> 
                                        Utilisez les outils ci-dessus pour formater et valider votre JSON. 
                                        Un JSON invalide causera des erreurs dans l'application.
                                    </small>
                                </div>
                            </div>
                        </div>

                        <!-- Configuration du Stock Vivant -->
                        <div id="stock-vivant-config" class="config-panel">
                            <div class="config-header">
                                <h3><i class="fas fa-seedling"></i> Configuration du Stock Vivant</h3>
                                <div class="config-actions">
                                    <button type="button" id="save-stock-vivant-config" class="btn btn-success" disabled>
                                        <i class="fas fa-save"></i> Sauvegarder
                                    </button>
                                    <button type="button" id="reload-stock-vivant-config" class="btn btn-secondary">
                                        <i class="fas fa-sync"></i> Recharger
                                    </button>
                                </div>
                            </div>
                            
                            <div class="config-editor">
                                <div class="form-group">
                                    <label for="stock-vivant-json-editor">Configuration JSON du Stock Vivant</label>
                                    
                                    <!-- Toolbar pour l'√©diteur -->
                                    <div class="json-toolbar">
                                        <div class="toolbar-group">
                                            <button type="button" class="btn btn-sm btn-tool" id="format-stock-vivant-json" title="Formater le JSON">
                                                <i class="fas fa-code"></i> Formater
                                            </button>
                                            <button type="button" class="btn btn-sm btn-tool" id="minify-stock-vivant-json" title="Minifier le JSON">
                                                <i class="fas fa-compress"></i> Minifier
                                            </button>
                                            <button type="button" class="btn btn-sm btn-tool" id="validate-stock-vivant-json" title="Valider le JSON">
                                                <i class="fas fa-check-circle"></i> Valider
                                            </button>
                                        </div>
                                        <div class="toolbar-group">
                                            <button type="button" class="btn btn-sm btn-tool" id="undo-stock-vivant" title="Annuler">
                                                <i class="fas fa-undo"></i>
                                            </button>
                                            <button type="button" class="btn btn-sm btn-tool" id="redo-stock-vivant" title="Refaire">
                                                <i class="fas fa-redo"></i>
                                            </button>
                                        </div>
                                        <div class="toolbar-info">
                                            <span class="line-info" id="stock-vivant-line-info">Ligne 1, Col 1</span>
                                        </div>
                                    </div>

                                    <div class="json-editor-container">
                                        <div class="json-line-numbers" id="stock-vivant-line-numbers">1</div>
                                        <textarea id="stock-vivant-json-editor" class="json-editor" rows="25" placeholder="Chargement de la configuration..."></textarea>
                                    </div>
                                    
                                    <div class="json-status" id="stock-vivant-json-status">
                                        <span class="status-indicator status-valid">
                                            <i class="fas fa-check-circle"></i> JSON valide
                                        </span>
                                    </div>
                                    
                                    <small class="form-help">
                                        <i class="fas fa-info-circle"></i> 
                                        Cette configuration d√©finit les cat√©gories et labels pour le stock vivant.
                                        Utilisez les outils ci-dessus pour formater et valider votre JSON.
                                    </small>
                                </div>
                            </div>
                        </div>

                        <!-- Configuration des Param√®tres Financiers -->
                        <div id="financial-config" class="config-panel">
                            <div class="config-header">
                                <h3><i class="fas fa-chart-line"></i> Param√®tres Financiers</h3>
                                <div class="config-actions">
                                    <button type="button" id="save-financial-config" class="btn btn-success" disabled>
                                        <i class="fas fa-save"></i> Sauvegarder
                                    </button>
                                    <button type="button" id="reload-financial-config" class="btn btn-secondary">
                                        <i class="fas fa-sync"></i> Recharger
                                    </button>
                                </div>
                            </div>

                            <!-- Interface conviviale pour les param√®tres principaux -->
                            <div class="financial-settings-panel">
                                <h4><i class="fas fa-sliders-h"></i> Param√®tres Principaux</h4>
                                
                                <div class="form-row">
                                    <div class="form-group col-md-6">
                                        <label for="charges-fixes-input">
                                            <i class="fas fa-calculator"></i> Estimation des charges fixes mensuelles (FCFA)
                                        </label>
                                        <input type="number" class="form-control" id="charges-fixes-input" 
                                               min="0" step="1000" placeholder="5320000">
                                        <small class="form-text text-muted">
                                            Montant utilis√© pour les calculs de charges prorata dans le PL
                                        </small>
                                    </div>
                                    
                                    <div class="form-group col-md-6">
                                        <label>
                                            <i class="fas fa-shield-alt"></i> Validation des d√©penses
                                        </label>
                                        <div class="validation-slider-container">
                                            <label class="slider-switch">
                                                <input type="checkbox" id="validate-balance-toggle" checked>
                                                <span class="slider"></span>
                                            </label>
                                            <div class="slider-label">
                                                <div class="slider-status enabled" id="validation-status-text">Validation activ√©e</div>
                                                <div class="slider-description" id="validation-description">Les d√©penses ne peuvent pas d√©passer le solde du compte</div>
                                            </div>
                                            <i class="fas fa-shield-alt slider-icon enabled" id="validation-icon"></i>
                                        </div>
                                        <small class="form-text text-muted">
                                            Cette option permet d'activer ou d√©sactiver la v√©rification de solde lors des d√©penses
                                        </small>
                                    </div>
                                </div>

                                <div class="alert alert-info">
                                    <i class="fas fa-info-circle"></i>
                                    <strong>Note :</strong> La d√©sactivation de la validation des d√©penses permet d'autoriser les d√©penses 
                                    m√™me si le solde du compte est insuffisant. Cette option est r√©serv√©e aux r√¥les Directeur G√©n√©ral, 
                                    PCA et Admin uniquement.
                                </div>
                            </div>
                            
                            <div class="config-editor">
                                <div class="form-group">
                                    <label for="financial-json-editor">Configuration JSON des Param√®tres Financiers</label>
                                    
                                    <!-- Toolbar pour l'√©diteur -->
                                    <div class="json-toolbar">
                                        <div class="toolbar-group">
                                            <button type="button" class="btn btn-sm btn-tool" id="format-financial-json" title="Formater le JSON">
                                                <i class="fas fa-code"></i> Formater
                                            </button>
                                            <button type="button" class="btn btn-sm btn-tool" id="minify-financial-json" title="Minifier le JSON">
                                                <i class="fas fa-compress"></i> Minifier
                                            </button>
                                            <button type="button" class="btn btn-sm btn-tool" id="validate-financial-json" title="Valider le JSON">
                                                <i class="fas fa-check-circle"></i> Valider
                                            </button>
                                        </div>
                                        <div class="toolbar-group">
                                            <button type="button" class="btn btn-sm btn-tool" id="undo-financial" title="Annuler (Ctrl+Z)">
                                                <i class="fas fa-undo"></i> Annuler
                                            </button>
                                            <button type="button" class="btn btn-sm btn-tool" id="redo-financial" title="Refaire (Ctrl+Y)">
                                                <i class="fas fa-redo"></i> Refaire
                                            </button>
                                        </div>
                                        <div class="toolbar-group">
                                            <span class="validation-status" id="financial-validation-status">
                                                <i class="fas fa-circle" style="color: #6b7280;"></i> Pr√™t
                                            </span>
                                            <span class="cursor-position" id="financial-cursor-position">Ligne 1, Col 1</span>
                                            <span class="json-stats" id="financial-json-stats">0 objets, 0 tableaux</span>
                                        </div>
                                    </div>
                                    
                                    <div class="json-editor-container">
                                        <div class="line-numbers" id="financial-line-numbers">1</div>
                                        <textarea 
                                            id="financial-json-editor" 
                                            class="json-editor" 
                                            placeholder="Chargement de la configuration..."
                                            spellcheck="false"
                                        ></textarea>
                                    </div>
                                    
                                    <small class="form-help">
                                        <i class="fas fa-info-circle"></i> 
                                        Cette configuration d√©finit les param√®tres financiers du syst√®me.
                                        Utilisez les outils ci-dessus pour formater et valider votre JSON.
                                    </small>
                                </div>
                            </div>
                        </div>

                        <!-- Permissions Stock Vivant -->
                        <div id="stock-permissions-config" class="config-panel">
                            <div class="config-header">
                                <h3><i class="fas fa-user-check"></i> Permissions Stock Vivant</h3>
                                <p class="section-description">G√©rer les permissions d'acc√®s au stock vivant pour les directeurs</p>
                            </div>
                            
                            <div class="permissions-management">
                                <div class="grant-permission-card">
                                    <h4><i class="fas fa-user-plus"></i> Accorder une Permission</h4>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="director-select">S√©lectionner un directeur</label>
                                            <select id="director-select" class="form-select">
                                                <option value="">Chargement des directeurs...</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <button id="grant-permission-btn" type="button" class="btn btn-success">
                                                <i class="fas fa-check"></i> Accorder l'acc√®s
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="current-permissions-card">
                                    <h4><i class="fas fa-users"></i> Permissions Actuelles</h4>
                                    <div id="permissions-list" class="permissions-list">
                                        <p>Chargement des permissions...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Section Visualisation -->
                <section id="visualisation-section" class="section">
                    <h2><i class="fas fa-chart-line"></i> Visualisation des Donn√©es</h2>
                    <p class="section-description">Analyse et visualisation des indicateurs financiers cl√©s</p>

                    <div class="visualisation-tabs">
                        <div class="tab-buttons">
                            <button type="button" class="tab-button active" data-viz="pl">
                                <i class="fas fa-chart-line"></i> PL avec √âcart Stock
                            </button>
                            <button type="button" class="tab-button" data-viz="stock-vivant">
                                <i class="fas fa-seedling"></i> Total G√©n√©ral Stock Vivant
                            </button>
                            <button type="button" class="tab-button" data-viz="stock-pv">
                                <i class="fas fa-boxes"></i> Stock Point de Vente
                            </button>
                            <button type="button" class="tab-button" data-viz="solde">
                                <i class="fas fa-wallet"></i> Solde
                            </button>
                        </div>

                        <!-- Contr√¥les communs -->
                        <div class="visualisation-controls">
                            <div class="control-row">
                                <div class="form-group">
                                    <label for="viz-period-type">P√©riode d'affichage</label>
                                    <select id="viz-period-type" class="form-control">
                                        <option value="daily">Par jour</option>
                                        <option value="weekly">Par semaine</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="viz-date-range">Plage de dates</label>
                                    <div class="date-range-inputs">
                                        <input type="date" id="viz-start-date" class="form-control">
                                        <span>√†</span>
                                        <input type="date" id="viz-end-date" class="form-control">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <button id="viz-refresh" class="btn btn-primary">
                                        <i class="fas fa-sync"></i> Actualiser
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- PL avec √âcart Stock -->
                        <div id="pl-viz" class="viz-panel active">
                            <div class="viz-header">
                                <h3><i class="fas fa-chart-line"></i> PL (avec √©cart stock mensuel et estim. charges)</h3>
                            </div>
                            
                            <div class="chart-container">
                                <canvas id="pl-chart"></canvas>
                            </div>
                            
                            <div class="data-table-container">
                                <h4><i class="fas fa-table"></i> Donn√©es d√©taill√©es</h4>
                                <div class="table-responsive">
                                    <table id="pl-data-table" class="data-table">
                                        <thead>
                                            <tr>
                                                <th>Date</th>
                                                <th>Cash Bictorys</th>
                                                <th>Cr√©ances</th>
                                                <th>Stock PV (FCFA)</th>
                                                <th>√âcart Stock Vivant</th>
                                                <th>Livraisons Partenaires</th>
                                                <th>Cash Burn</th>
                                                <th>Charges Estim√©es</th>
                                                <th>PL Final</th>
                                            </tr>
                                        </thead>
                                        <tbody id="pl-data-tbody">
                                            <!-- Donn√©es g√©n√©r√©es dynamiquement -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Total G√©n√©ral Stock Vivant -->
                        <div id="stock-vivant-viz" class="viz-panel">
                            <div class="viz-header">
                                <h3><i class="fas fa-seedling"></i> Total G√©n√©ral Stock Vivant</h3>
                                <p class="viz-description">√âvolution du stock vivant (ignore les jours sans donn√©es)</p>
                            </div>
                            
                            <div class="chart-container">
                                <canvas id="stock-vivant-chart"></canvas>
                            </div>
                            
                            <div class="data-table-container">
                                <h4><i class="fas fa-table"></i> Donn√©es d√©taill√©es</h4>
                                <div class="table-responsive">
                                    <table id="stock-vivant-data-table" class="data-table">
                                        <thead>
                                            <tr>
                                                <th>Date</th>
                                                <th>Total Stock Vivant</th>
                                                <th>Variation</th>
                                                <th>Nombre d'entr√©es</th>
                                            </tr>
                                        </thead>
                                        <tbody id="stock-vivant-data-tbody">
                                            <!-- Donn√©es g√©n√©r√©es dynamiquement -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Stock Point de Vente -->
                        <div id="stock-pv-viz" class="viz-panel">
                            <div class="viz-header">
                                <h3><i class="fas fa-boxes"></i> Stock Point de Vente</h3>
                                <p class="viz-description">√âvolution du stock point de vente</p>
                            </div>
                            
                            <div class="chart-container">
                                <canvas id="stock-pv-chart"></canvas>
                            </div>
                            
                            <div class="data-table-container">
                                <h4><i class="fas fa-table"></i> Donn√©es d√©taill√©es</h4>
                                <div class="table-responsive">
                                    <table id="stock-pv-data-table" class="data-table">
                                        <thead>
                                            <tr>
                                                <th>Date</th>
                                                <th>Stock Point de Vente</th>
                                                <th>Variation</th>
                                                <th>Points de vente</th>
                                            </tr>
                                        </thead>
                                        <tbody id="stock-pv-data-tbody">
                                            <!-- Donn√©es g√©n√©r√©es dynamiquement -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Solde -->
                        <div id="solde-viz" class="viz-panel">
                            <div class="viz-header">
                                <h3><i class="fas fa-wallet"></i> Solde</h3>
                                <p class="viz-description">√âvolution du solde g√©n√©ral</p>
                            </div>
                            
                            <div class="chart-container">
                                <canvas id="solde-chart"></canvas>
                            </div>
                            
                            <div class="data-table-container">
                                <h4><i class="fas fa-table"></i> Donn√©es d√©taill√©es</h4>
                                <div class="table-responsive">
                                    <table id="solde-data-table" class="data-table">
                                        <thead>
                                            <tr>
                                                <th>Date</th>
                                                <th>Solde Total</th>
                                                <th>Variation</th>
                                                <th>Comptes Actifs</th>
                                            </tr>
                                        </thead>
                                        <tbody id="solde-data-tbody">
                                            <!-- Donn√©es g√©n√©r√©es dynamiquement -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Section Audit Flux -->
                <section id="audit-flux-section" class="section">
                    <h2><i class="fas fa-search-dollar"></i> Audit Flux de Compte</h2>
                    
                    <div class="audit-controls">
                        <div class="form-group">
                            <label for="audit-account-select">
                                <i class="fas fa-wallet"></i> S√©lectionner un compte √† auditer
                            </label>
                            <select id="audit-account-select" class="form-control">
                                <option value="">Choisir un compte...</option>
                            </select>
                        </div>
                        
                        <div class="audit-date-filters">
                            <div class="form-group">
                                <label for="audit-start-date">Date de d√©but</label>
                                <input type="date" id="audit-start-date" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="audit-end-date">Date de fin</label>
                                <input type="date" id="audit-end-date" class="form-control">
                            </div>
                            <button id="audit-filter-btn" class="btn btn-secondary">
                                <i class="fas fa-filter"></i> Filtrer
                            </button>
                        </div>
                        
                        <button id="audit-execute-btn" class="btn btn-primary" disabled>
                            <i class="fas fa-search"></i> Auditer le Compte
                        </button>
                        
                        <!-- Boutons d'audit de coh√©rence pour DG/PCA/Admin -->
                        <div id="audit-consistency-controls" class="audit-consistency-controls" style="display: none;">
                            <div class="consistency-buttons">
                                <button id="audit-detect-inconsistencies-btn" class="btn btn-warning">
                                    <i class="fas fa-exclamation-triangle"></i> D√©tecter les Incoh√©rences
                                </button>
                                <button id="audit-fix-inconsistencies-btn" class="btn btn-danger">
                                    <i class="fas fa-wrench"></i> Corriger les Incoh√©rences
                                </button>
                            </div>
                            <div class="consistency-info">
                                <small class="text-muted">
                                    <i class="fas fa-info-circle"></i> 
                                    Ces boutons permettent de d√©tecter et corriger automatiquement les incoh√©rences 
                                    entre les donn√©es stock√©es et les calculs r√©els des comptes.
                                </small>
                            </div>
                        </div>

                        <!-- Boutons de synchronisation s√©lective pour DG/PCA/Admin -->
                        <div id="audit-sync-controls" class="audit-sync-controls" style="display: none;">
                            <div class="sync-header">
                                <h4><i class="fas fa-sync-alt"></i> Synchronisation des Comptes</h4>
                            </div>
                            <div class="sync-buttons">
                                <button id="audit-sync-all-btn" class="btn btn-primary">
                                    <i class="fas fa-globe"></i> Synchroniser TOUS les Comptes
                                </button>
                                <div class="sync-selective">
                                    <select id="audit-sync-account-select" class="form-control" style="display: inline-block; width: auto; margin-right: 10px;">
                                        <option value="">-- Choisir un compte --</option>
                                    </select>
                                    <button id="audit-sync-selected-btn" class="btn btn-warning" disabled>
                                        <i class="fas fa-sync"></i> Synchroniser
                                    </button>
                                </div>
                            </div>
                            <div class="sync-info">
                                <small class="text-muted">
                                    <i class="fas fa-info-circle"></i> 
                                    Force la resynchronisation des comptes selon la logique Audit Flux.
                                    Utilisez en cas de d√©synchronisation persistante.
                                </small>
                            </div>
                            <div id="sync-results" class="sync-results" style="display: none; margin-top: 15px;"></div>
                        </div>
                    </div>
                    
                    <!-- Informations du compte -->
                    <div id="audit-account-info" class="audit-account-info" style="display: none;">
                        <h3><i class="fas fa-info-circle"></i> Informations du Compte</h3>
                        <div class="account-info-grid">
                            <div class="info-item">
                                <span class="info-label">Nom du compte :</span>
                                <span class="info-value" id="audit-account-name">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Type de compte :</span>
                                <span class="info-value" id="audit-account-type">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Solde actuel :</span>
                                <span class="info-value" id="audit-account-balance">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Total cr√©dit√© :</span>
                                <span class="info-value" id="audit-account-credited">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Total d√©pens√© :</span>
                                <span class="info-value" id="audit-account-spent">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Transferts entrants :</span>
                                <span class="info-value" id="audit-account-transfert-entrants">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Transferts sortants :</span>
                                <span class="info-value" id="audit-account-transfert-sortants">-</span>
                            </div>
                            <div class="info-item" id="audit-adjustment-item" style="display: none;">
                                <span class="info-label">Ajustement mois courant :</span>
                                <span class="info-value" id="audit-account-adjustment">-</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- R√©sultats de l'audit -->
                    <div id="audit-results" class="audit-results" style="display: none;">
                        
                        <!-- Section de d√©tection d'incoh√©rences -->
                        <div id="audit-consistency-results" class="audit-consistency-results" style="display: none;">
                            <div class="consistency-header">
                                <h3><i class="fas fa-exclamation-triangle"></i> D√©tection d'Incoh√©rences</h3>
                                <div class="consistency-stats">
                                    <span class="stat-item">
                                        <i class="fas fa-exclamation-circle"></i>
                                        <span id="consistency-total-issues">0</span> incoh√©rences d√©tect√©es
                                    </span>
                                </div>
                            </div>
                            
                            <div class="table-container">
                                <table class="data-table" id="consistency-issues-table">
                                    <thead>
                                        <tr>
                                            <th>Compte</th>
                                            <th>Total Cr√©dit√© (Stock√©)</th>
                                            <th>Total Cr√©dit√© (Calcul√©)</th>
                                            <th>Diff√©rence Cr√©dits</th>
                                            <th>Total D√©pens√© (Stock√©)</th>
                                            <th>Total D√©pens√© (Calcul√©)</th>
                                            <th>Diff√©rence D√©penses</th>
                                            <th>Solde (Stock√©)</th>
                                            <th>Solde (Calcul√©)</th>
                                            <th>Diff√©rence Solde</th>
                                        </tr>
                                    </thead>
                                    <tbody id="consistency-issues-tbody">
                                        <!-- Les incoh√©rences seront ajout√©es ici -->
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="consistency-actions">
                                <button id="consistency-export-csv" class="btn btn-secondary">
                                    <i class="fas fa-download"></i> Exporter en CSV
                                </button>
                                <button id="consistency-fix-all-btn" class="btn btn-danger">
                                    <i class="fas fa-wrench"></i> Corriger Toutes les Incoh√©rences
                                </button>
                            </div>
                        </div>
                        <div class="audit-header">
                            <h3><i class="fas fa-list-alt"></i> Historique des Mouvements</h3>
                            <div class="audit-stats">
                                <span class="stat-item">
                                    <i class="fas fa-hashtag"></i>
                                    <span id="audit-total-operations">0</span> op√©rations
                                </span>
                                <span class="stat-item">
                                    <i class="fas fa-calendar-alt"></i>
                                    P√©riode : <span id="audit-period">-</span>
                                </span>
                            </div>
                        </div>
                        
                        <!-- Filtres pour l'historique -->
                        <div class="audit-filters" style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                            <div style="display: flex; align-items: center; gap: 20px; flex-wrap: wrap;">
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-filter" style="color: #6c757d;"></i>
                                    <label for="operation-type-filter" style="font-weight: 600; color: #495057;">
                                        Filtrer par Type :
                                    </label>
                                </div>
                                <select id="operation-type-filter" style="padding: 8px 12px; border: 1px solid #ced4da; border-radius: 6px; background: white; min-width: 200px;">
                                    <option value="all">üîç Tous les types</option>
                                    <option value="CR√âDIT">üí∞ Cr√©dits r√©guliers</option>
                                    <option value="CR√âDIT SP√âCIAL">‚≠ê Cr√©dits sp√©ciaux</option>
                                    <option value="D√âPENSE">üí∏ D√©penses</option>
                                    <option value="TRANSFERT ENTRANT">üì• Transferts entrants</option>
                                    <option value="TRANSFERT SORTANT">üì§ Transferts sortants</option>
                                </select>
                                <div style="display: flex; align-items: center; gap: 8px; margin-left: auto;">
                                    <span id="filtered-count" style="color: #6c757d; font-size: 14px;">
                                        Affichage : <strong id="visible-operations">0</strong> / <strong id="total-operations-filter">0</strong>
                                    </span>
                                    <button id="reset-filters-btn" style="padding: 6px 12px; background: #6c757d; color: white; border: none; border-radius: 4px; font-size: 12px;">
                                        <i class="fas fa-undo"></i> Reset
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="audit-summary">
                            <div class="summary-cards">
                                <div class="summary-card positive">
                                    <div class="card-icon">
                                        <i class="fas fa-plus-circle"></i>
                                    </div>
                                    <div class="card-content">
                                        <h4>Total Cr√©dits</h4>
                                        <span class="card-value" id="audit-total-credits">0 FCFA</span>
                                    </div>
                                </div>
                                <div class="summary-card negative">
                                    <div class="card-icon">
                                        <i class="fas fa-minus-circle"></i>
                                    </div>
                                    <div class="card-content">
                                        <h4>Total D√©bits</h4>
                                        <span class="card-value" id="audit-total-debits">0 FCFA</span>
                                    </div>
                                </div>
                                <div class="summary-card neutral">
                                    <div class="card-icon">
                                        <i class="fas fa-balance-scale"></i>
                                    </div>
                                    <div class="card-content">
                                        <h4>Solde Net</h4>
                                        <span class="card-value" id="audit-net-balance">0 FCFA</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Notes explicatives sur les diff√©rences comptables -->
                        <div class="audit-info-note" style="margin: 20px 0; padding: 15px; background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%); border-left: 4px solid #2196f3; border-radius: 8px; font-size: 14px;">
                            <div style="display: flex; align-items: flex-start; gap: 12px;">
                                <i class="fas fa-info-circle" style="color: #2196f3; font-size: 18px; margin-top: 2px; flex-shrink: 0;"></i>
                                <div>
                                    <h4 style="margin: 0 0 12px 0; color: #1976d2; font-size: 16px; font-weight: 600;">
                                        üí° Comprendre les diff√©rences comptables
                                    </h4>
                                    <div style="color: #424242; line-height: 1.5;">
                                        <div style="margin-bottom: 16px;">
                                            <h5 style="margin: 0 0 6px 0; color: #1976d2; font-size: 14px; font-weight: 600;">
                                                üì§ D√âBITS : Total D√©pens√© vs Total D√©bits
                                            </h5>
                                            <p style="margin: 0 0 4px 0;">
                                                <strong>üî∏ "Total D√©pens√©"</strong> = D√©penses op√©rationnelles uniquement (achats, frais, charges)
                                            </p>
                                            <p style="margin: 0 0 8px 0;">
                                                <strong>üî∏ "Total D√©bits"</strong> = D√©penses + Transferts sortants (vision comptable compl√®te)
                                            </p>
                                        </div>
                                        <div style="margin-bottom: 16px;">
                                            <h5 style="margin: 0 0 6px 0; color: #1976d2; font-size: 14px; font-weight: 600;">
                                                üì• CR√âDITS : Total Cr√©dit√© vs Total Cr√©dits
                                            </h5>
                                            <p style="margin: 0 0 4px 0;">
                                                <strong>üî∏ "Total Cr√©dit√©"</strong> = Cr√©dits op√©rationnels uniquement (injections d'argent, remboursements)
                                            </p>
                                            <p style="margin: 0 0 8px 0;">
                                                <strong>üî∏ "Total Cr√©dits"</strong> = Cr√©dits + Transferts entrants (vision comptable compl√®te)
                                            </p>
                                        </div>
                                        <p style="margin: 0; padding: 10px 12px; background: rgba(76, 175, 80, 0.15); border-radius: 6px; border-left: 3px solid #4CAF50;">
                                            <strong>üìä Les diff√©rences</strong> correspondent aux <strong>transferts internes</strong> : mouvements d'argent entre comptes (pas des op√©rations avec l'ext√©rieur).
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table class="data-table" id="audit-movements-table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Heure</th>
                                        <th>Type d'Op√©ration</th>
                                        <th>Montant</th>
                                        <th>Description</th>
                                        <th>Effectu√© par</th>
                                        <th>Date de cr√©ation</th>
                                    </tr>
                                </thead>
                                <tbody id="audit-movements-tbody">
                                    <!-- Les mouvements seront ajout√©s ici -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="audit-export">
                            <button id="audit-export-csv" class="btn btn-secondary">
                                <i class="fas fa-download"></i> Exporter en CSV
                            </button>
                            <button id="audit-export-sql" class="btn btn-info">
                                <i class="fas fa-code"></i> Voir la Requ√™te SQL
                            </button>
                        </div>
                    </div>
                    
                    <!-- Modal pour afficher la requ√™te SQL -->
                    <div id="sql-modal" class="modal">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h2><i class="fas fa-code"></i> Requ√™te SQL Ex√©cut√©e</h2>
                                <span class="close" onclick="closeSqlModal()">&times;</span>
                            </div>
                            <div class="modal-body">
                                <div class="sql-container">
                                    <pre id="sql-query-display"></pre>
                                </div>
                                <button id="copy-sql-btn" class="btn btn-secondary">
                                    <i class="fas fa-copy"></i> Copier la Requ√™te
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Modal SQL Query -->
                    <div id="sql-modal" class="modal">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h2><i class="fas fa-code"></i> Requ√™te SQL G√©n√©r√©e</h2>
                                <button type="button" class="close" onclick="closeSqlModal()">&times;</button>
                            </div>
                            <div class="modal-body">
                                <p>Voici la requ√™te SQL g√©n√©r√©e pour l'audit de ce compte :</p>
                                <pre id="sql-query-display"></pre>
                                <button type="button" id="copy-sql-btn" class="btn">
                                    <i class="fas fa-copy"></i> Copier la Requ√™te
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Section Transfert -->
                <section id="transfert-section" class="section">
                    <h2>Transfert de Solde</h2>
                    
                    <!-- Formulaire de transfert -->
                    <div class="transfert-container">
                        <div class="transfert-form-section">
                            <h3><i class="fas fa-exchange-alt"></i> Nouveau Transfert</h3>
                            <form id="transfert-form" class="account-form" style="max-width: 500px; margin: 0 auto;">
                                <div class="form-group">
                                    <label for="transfert-source">Compte source</label>
                                    <select id="transfert-source" required>
                                        <option value="">S√©lectionner un compte</option>
                                    </select>
                                    <small id="solde-source-info" class="form-help" style="font-size: 12px; color: #666; display: none;"></small>
                                </div>
                                <div class="form-group">
                                    <label for="transfert-destination">Compte destination</label>
                                    <select id="transfert-destination" required>
                                        <option value="">S√©lectionner un compte</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="transfert-montant">Montant √† transf√©rer</label>
                                    <input type="number" id="transfert-montant" min="1" step="1" required placeholder="Montant en FCFA">
                                </div>
                                <div class="form-group">
                                    <label for="transfert-comment">Commentaire (optionnel)</label>
                                    <textarea id="transfert-comment" placeholder="Motif du transfert, note de rappel..." rows="2" style="resize: vertical;"></textarea>
                                    <small class="form-help">Ajoutez une note pour vous souvenir de ce transfert</small>
                                </div>
                                <button type="submit" class="btn btn-primary">Transf√©rer</button>
                                <div id="transfert-notification" class="notification" style="display:none;"></div>
                            </form>
                        </div>
                        
                        <!-- Section historique des transferts -->
                        <div class="transfert-history-section">
                            <div class="section-card">
                                <h3><i class="fas fa-history"></i> Historique des Transferts</h3>
                                
                                <!-- S√©lecteur de compte pour l'historique -->
                                <div class="history-controls">
                                    <div class="form-group">
                                        <label for="transfert-history-account">Compte √† consulter</label>
                                        <select id="transfert-history-account">
                                            <option value="">S√©lectionner un compte</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="transfert-history-start-date">Date de d√©but</label>
                                        <input type="date" id="transfert-history-start-date">
                                    </div>
                                    <div class="form-group">
                                        <label for="transfert-history-end-date">Date de fin</label>
                                        <input type="date" id="transfert-history-end-date">
                                    </div>
                                    <button id="load-transfert-history" class="btn btn-secondary">
                                        <i class="fas fa-search"></i> Charger l'historique
                                    </button>
                                </div>
                                
                                <!-- Tableau des transferts -->
                                <div class="table-container">
                                    <div id="transfert-history-list">
                                        <p class="text-muted text-center">S√©lectionnez un compte pour voir son historique de transferts</p>
                                    </div>
                                </div>
                                
                                <!-- Modal de confirmation de suppression -->
                                <div id="delete-transfert-modal" class="modal">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h2><i class="fas fa-exclamation-triangle"></i> Confirmer la suppression</h2>
                                            <span class="close" onclick="closeDeleteTransfertModal()">&times;</span>
                                        </div>
                                        <div class="modal-body">
                                            <div class="delete-confirmation">
                                                <p class="warning-text">
                                                    <i class="fas fa-exclamation-triangle"></i>
                                                    <strong>Attention !</strong> Cette action est irr√©versible.
                                                </p>
                                                <div class="transfer-details">
                                                    <h4>D√©tails du transfert √† supprimer :</h4>
                                                    <div class="detail-grid">
                                                        <div class="detail-row">
                                                            <span class="detail-label">Montant :</span>
                                                            <span class="detail-value" id="delete-transfert-montant"></span>
                                                        </div>
                                                        <div class="detail-row">
                                                            <span class="detail-label">De :</span>
                                                            <span class="detail-value" id="delete-transfert-source"></span>
                                                        </div>
                                                        <div class="detail-row">
                                                            <span class="detail-label">Vers :</span>
                                                            <span class="detail-value" id="delete-transfert-destination"></span>
                                                        </div>
                                                        <div class="detail-row">
                                                            <span class="detail-label">Date :</span>
                                                            <span class="detail-value" id="delete-transfert-date"></span>
                                                        </div>
                                                        <div class="detail-row">
                                                            <span class="detail-label">Par :</span>
                                                            <span class="detail-value" id="delete-transfert-user"></span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="impact-warning">
                                                    <p><strong>Impact de la suppression :</strong></p>
                                                    <ul>
                                                        <li>Le montant sera rembours√© au compte source</li>
                                                        <li>Le montant sera d√©bit√© du compte destination</li>
                                                        <li>Le transfert sera d√©finitivement supprim√© de l'historique</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button id="confirm-delete-transfert" class="btn btn-danger">
                                                <i class="fas fa-trash-alt"></i> Supprimer d√©finitivement
                                            </button>
                                            <button onclick="closeDeleteTransfertModal()" class="btn btn-secondary">
                                                <i class="fas fa-times"></i> Annuler
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Section Historique des Snapshots -->
                <section id="snapshots-history-section" class="section">
                    <div class="section-header">
                        <h2><i class="fas fa-history"></i> Historique des Snapshots</h2>
                        <p class="section-description">Consultez et g√©rez les instantan√©s quotidiens des donn√©es de l'application</p>
                    </div>

                    <!-- Contr√¥les de gestion -->
                    <div class="snapshots-controls-section">
                        <div class="control-panel">
                            <div class="form-group">
                                <label for="snapshot-cutoff-date">
                                    <i class="fas fa-calendar-alt"></i> Date de r√©f√©rence pour un nouveau snapshot
                                </label>
                                <input type="date" id="snapshot-cutoff-date" class="form-control">
                                <small class="form-help">Laissez vide pour utiliser la date d'aujourd'hui</small>
                            </div>
                            <button id="create-snapshot-btn" class="btn btn-primary">
                                <i class="fas fa-camera"></i> Cr√©er un Snapshot
                            </button>
                            <button id="refresh-snapshots-btn" class="btn btn-secondary">
                                <i class="fas fa-sync-alt"></i> Actualiser la liste
                            </button>
                        </div>
                    </div>

                    <!-- Liste des snapshots -->
                    <div class="snapshots-list-section">
                        <div class="section-card">
                            <h3><i class="fas fa-archive"></i> Snapshots Disponibles</h3>
                            
                            <div class="table-container">
                                <div id="snapshots-loading" class="loading-message" style="display: none;">
                                    <i class="fas fa-spinner fa-spin"></i> Chargement des snapshots...
                                </div>
                                
                                <div id="snapshots-list">
                                    <div class="no-data-message">
                                        <i class="fas fa-inbox"></i>
                                        <p>Aucun snapshot disponible pour le moment</p>
                                        <small>Cr√©ez votre premier snapshot pour commencer</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Zone de visualisation des donn√©es de snapshot -->
                    <div id="snapshot-viewer-section" class="snapshot-viewer" style="display: none;">
                        <div class="viewer-header">
                            <h3 id="viewer-title">
                                <i class="fas fa-eye"></i> Consultation du Snapshot
                            </h3>
                            <button id="close-snapshot-viewer" class="btn btn-secondary">
                                <i class="fas fa-times"></i> Fermer
                            </button>
                        </div>
                        
                        <div class="snapshot-tabs">
                            <button class="tab-btn active" data-tab="dashboard-data">
                                <i class="fas fa-tachometer-alt"></i> Dashboard
                            </button>
                            <button class="tab-btn" data-tab="expenses-data">
                                <i class="fas fa-receipt"></i> D√©penses
                            </button>
                            <button class="tab-btn" data-tab="creances-data">
                                <i class="fas fa-money-check-alt"></i> Cr√©ances
                            </button>
                            <button class="tab-btn" data-tab="stock-data">
                                <i class="fas fa-warehouse"></i> Stock
                            </button>
                            <button class="tab-btn" data-tab="partners-data">
                                <i class="fas fa-handshake"></i> Partenaires
                            </button>
                        </div>
                        
                        <div class="tab-content">
                            <div id="dashboard-data" class="tab-pane active">
                                <div id="snapshot-dashboard-content">
                                    <!-- Contenu dashboard affich√© ici -->
                                </div>
                            </div>
                            
                            <div id="expenses-data" class="tab-pane">
                                <div id="snapshot-expenses-content">
                                    <!-- Contenu d√©penses affich√© ici -->
                                </div>
                            </div>
                            
                            <div id="creances-data" class="tab-pane">
                                <div id="snapshot-creances-content">
                                    <!-- Contenu cr√©ances affich√© ici -->
                                </div>
                            </div>
                            
                            <div id="stock-data" class="tab-pane">
                                <div id="snapshot-stock-content">
                                    <!-- Contenu gestion de stock affich√© ici -->
                                </div>
                            </div>
                            
                            <div id="partners-data" class="tab-pane">
                                <div id="snapshot-partners-content">
                                    <!-- Contenu partenaires affich√© ici -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Notification des actions snapshots -->
                    <div id="snapshots-notification" class="notification" style="display: none;"></div>
                </section>
            </main>
        </div>
    </div>

    <!-- Messages de notification -->
    <div id="notification" class="notification"></div>

    <!-- Modal de confirmation pour ajouter une d√©pense -->
    <div id="expense-confirmation-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-check-circle"></i> Confirmer l'ajout de la d√©pense</h2>
                <span class="close" onclick="closeExpenseConfirmationModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="confirmation-summary">
                    <h3><i class="fas fa-receipt"></i> R√©sum√© de la d√©pense</h3>
                    
                    <div class="summary-grid">
                        <div class="summary-row">
                            <span class="summary-label">Compte :</span>
                            <span class="summary-value" id="confirm-account"></span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-label">Type :</span>
                            <span class="summary-value" id="confirm-type"></span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-label">Cat√©gorie :</span>
                            <span class="summary-value" id="confirm-category"></span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-label">Sous-cat√©gorie :</span>
                            <span class="summary-value" id="confirm-subcategory"></span>
                        </div>
                        <div class="summary-row" id="confirm-social-row" style="display: none;">
                            <span class="summary-label">R√©seau social :</span>
                            <span class="summary-value" id="confirm-social"></span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-label">Date :</span>
                            <span class="summary-value" id="confirm-date"></span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-label">D√©signation :</span>
                            <span class="summary-value" id="confirm-designation"></span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-label">Fournisseur :</span>
                            <span class="summary-value" id="confirm-supplier"></span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-label">Quantit√© :</span>
                            <span class="summary-value" id="confirm-quantity"></span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-label">Prix unitaire :</span>
                            <span class="summary-value" id="confirm-unit-price"></span>
                        </div>
                        <div class="summary-row total-row">
                            <span class="summary-label">Total :</span>
                            <span class="summary-value" id="confirm-total"></span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-label">Pr√©visible :</span>
                            <span class="summary-value" id="confirm-predictable"></span>
                        </div>
                        <div class="summary-row" id="confirm-description-row" style="display: none;">
                            <span class="summary-label">Description :</span>
                            <span class="summary-value" id="confirm-description"></span>
                        </div>
                        <div class="summary-row" id="confirm-file-row" style="display: none;">
                            <span class="summary-label">Justificatif :</span>
                            <span class="summary-value" id="confirm-file"></span>
                        </div>
                    </div>

                    <!-- Validation du budget -->
                    <div class="budget-validation" id="budget-validation">
                        <!-- Les informations de validation du budget seront affich√©es ici -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeExpenseConfirmationModal()">
                    <i class="fas fa-times"></i> Annuler
                </button>
                <button type="button" class="btn btn-success" id="confirm-expense-btn" onclick="confirmAndSubmitExpense()">
                    <i class="fas fa-check"></i> Confirmer l'ajout
                </button>
            </div>
        </div>
    </div>

    <!-- Popup pour modifier une d√©pense -->
    <div id="edit-expense-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Modifier la D√©pense</h2>
                <span class="close" onclick="closeEditModal()">&times;</span>
            </div>
            <form id="edit-expense-form" class="expense-form">
                <input type="hidden" id="edit-expense-id" name="expense_id">
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-expense-account">Compte</label>
                        <select id="edit-expense-account" name="account_id" required>
                            <option value="">S√©lectionner un compte</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-expense-type">Type de D√©pense</label>
                        <select id="edit-expense-type" name="expense_type" required>
                            <option value="">S√©lectionner un type</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-expense-category">Cat√©gorie</label>
                        <select id="edit-expense-category" name="category" required>
                            <option value="">S√©lectionner une cat√©gorie</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-expense-subcategory">Sous-cat√©gorie</label>
                        <select id="edit-expense-subcategory" name="subcategory">
                            <option value="">S√©lectionner une sous-cat√©gorie</option>
                        </select>
                    </div>
                </div>
                
                <!-- Champ sp√©cial pour les r√©seaux sociaux -->
                <div class="form-row" id="edit-social-network-row" style="display: none;">
                    <div class="form-group">
                        <label for="edit-social-network-detail">Pr√©ciser le r√©seau social</label>
                        <select id="edit-social-network-detail" name="social_network_detail">
                            <option value="">S√©lectionner un r√©seau</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-expense-date">Date</label>
                        <input type="date" id="edit-expense-date" name="expense_date" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-expense-designation">D√©signation</label>
                        <input type="text" id="edit-expense-designation" name="designation" required placeholder="Ex: Achat de mat√©riel, Service de transport...">
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-expense-supplier">Nom Fournisseur</label>
                        <input type="text" id="edit-expense-supplier" name="supplier" required placeholder="Nom du fournisseur ou prestataire">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-expense-quantity">Quantit√©</label>
                        <input type="number" id="edit-expense-quantity" name="quantity" step="0.01" min="0" required placeholder="1">
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-expense-unit-price">Prix Unitaire (FCFA)</label>
                        <input type="number" id="edit-expense-unit-price" name="unit_price" step="1" min="0" required placeholder="0">
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-expense-total">Montant Total (FCFA)</label>
                        <input type="number" id="edit-expense-total" name="total" step="1" min="0" required placeholder="Calcul√© automatiquement">
                        <small class="form-help">Se calcule automatiquement ou saisissez manuellement</small>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-expense-predictable">Pr√©visible</label>
                        <select id="edit-expense-predictable" name="predictable" required>
                            <option value="">S√©lectionner</option>
                            <option value="oui" selected>Oui</option>
                            <option value="non">Non</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="edit-expense-description">Description/Commentaires</label>
                    <textarea id="edit-expense-description" name="description" placeholder="Informations compl√©mentaires..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="edit-expense-justification">Justificatif (Optionnel)</label>
                    <div class="file-input-wrapper">
                        <input type="file" id="edit-expense-justification" name="justification" 
                               accept=".jpg,.jpeg,.png,.pdf,.doc,.docx,.xls,.xlsx"
                               style="display: none;">
                        <button type="button" class="file-input-button" onclick="document.getElementById('edit-expense-justification').click();">
                            <i class="fas fa-upload"></i> <span id="edit-file-input-text">Choisir un fichier</span>
                        </button>
                        <button type="button" id="download-existing-justification" class="download-button" style="display: none;">
                            <i class="fas fa-download"></i> T√©l√©charger
                        </button>
                    </div>
                    <small id="edit-file-format-info">Formats: JPG, PNG, PDF, Word, Excel (Max: 5MB)</small>
                    <div id="remove-justification-container" style="display: none; margin-top: 10px;">
                        <input type="checkbox" id="remove-existing-justification" name="remove_justification">
                        <label for="remove-existing-justification">Supprimer le justificatif existant</label>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="cancel-btn" onclick="closeEditModal()">Annuler</button>
                    <button type="submit">Modifier la D√©pense</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Popup pour voir les d√©tails d'une d√©pense -->
    <div id="view-details-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>D√©tails de la D√©pense</h2>
                <span class="close" onclick="closeViewDetailsModal()">&times;</span>
            </div>
            <div class="expense-details-content">
                <div class="form-row">
                    <div class="form-group">
                        <label>Compte</label>
                        <div class="detail-value" id="view-expense-account"></div>
                    </div>
                    
                    <div class="form-group">
                        <label>Type de D√©pense</label>
                        <div class="detail-value" id="view-expense-type"></div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Cat√©gorie</label>
                        <div class="detail-value" id="view-expense-category"></div>
                    </div>
                    
                    <div class="form-group">
                        <label>Sous-cat√©gorie</label>
                        <div class="detail-value" id="view-expense-subcategory"></div>
                    </div>
                </div>
                
                <div class="form-row" id="view-social-network-row" style="display: none;">
                    <div class="form-group">
                        <label>R√©seau social</label>
                        <div class="detail-value" id="view-social-network-detail"></div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Date</label>
                        <div class="detail-value" id="view-expense-date"></div>
                    </div>
                    
                    <div class="form-group">
                        <label>Cr√©√© le</label>
                        <div class="detail-value" id="view-expense-created"></div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>D√©signation</label>
                        <div class="detail-value" id="view-expense-designation"></div>
                    </div>
                    
                    <div class="form-group">
                        <label>Nom Fournisseur</label>
                        <div class="detail-value" id="view-expense-supplier"></div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Quantit√©</label>
                        <div class="detail-value" id="view-expense-quantity"></div>
                    </div>
                    
                    <div class="form-group">
                        <label>Prix Unitaire (FCFA)</label>
                        <div class="detail-value" id="view-expense-unit-price"></div>
                    </div>
                    
                    <div class="form-group">
                        <label>Montant Total (FCFA)</label>
                        <div class="detail-value" id="view-expense-total"></div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Pr√©visible</label>
                        <div class="detail-value" id="view-expense-predictable"></div>
                    </div>
                    
                    <div class="form-group">
                        <label>Cr√©√© par</label>
                        <div class="detail-value" id="view-expense-username"></div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Description/Commentaires</label>
                    <div class="detail-value" id="view-expense-description"></div>
                </div>
                
                <div class="form-group">
                    <label>Justificatif</label>
                    <div class="detail-value" id="view-expense-justification"></div>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="cancel-btn" onclick="closeViewDetailsModal()">Fermer</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal pour ajouter/modifier une entr√©e de stock -->
    <div id="stock-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="stock-modal-title">Ajouter une entr√©e de stock</h2>
                <span class="close" onclick="closeStockModal()">&times;</span>
            </div>
            <form id="stock-form">
                <input type="hidden" id="stock-id" name="stock_id">
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="stock-date">Date</label>
                        <input type="date" id="stock-date" name="date" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="stock-point-vente">Point de Vente</label>
                        <input type="text" id="stock-point-vente" name="point_de_vente" required placeholder="Ex: Mbao, O.Foire, Keur Massar...">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="stock-produit">Produit</label>
                        <input type="text" id="stock-produit" name="produit" required placeholder="Ex: Boeuf, Poulet, Tablette...">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="stock-matin">Stock Matin (FCFA)</label>
                        <input type="number" id="stock-matin" name="stock_matin" step="0.01" min="0" placeholder="0">
                    </div>
                    
                    <div class="form-group">
                        <label for="stock-soir">Stock Soir (FCFA)</label>
                        <input type="number" id="stock-soir" name="stock_soir" step="0.01" min="0" placeholder="0">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="stock-transfert">Transfert (FCFA)</label>
                        <input type="number" id="stock-transfert" name="transfert" step="0.01" placeholder="0">
                    </div>
                    
                    <div class="form-group">
                        <label for="stock-vente-theorique">Vente Th√©orique (calcul√©e)</label>
                        <input type="number" id="stock-vente-theorique" readonly placeholder="Calcul√© automatiquement">
                        <small class="form-help">Stock Matin - Stock Soir + Transfert</small>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeStockModal()">Annuler</button>
                    <button type="submit" class="btn btn-primary" id="stock-submit-btn">Ajouter</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal pour copier depuis une date -->
    <div id="copy-stock-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-copy"></i> Copier les donn√©es depuis une date</h2>
                <span class="close" onclick="closeCopyStockModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="copy-stock-info">
                    <p><strong>Date de destination :</strong> <span id="copy-target-date"></span></p>
                    <p class="text-muted">S√©lectionnez une date <strong>ant√©rieure</strong> pour copier ses donn√©es vers la date de destination.</p>
                </div>
                
                <div class="form-group">
                    <label for="copy-source-date">Date source (date ant√©rieure avec donn√©es)</label>
                    <select id="copy-source-date" class="form-control">
                        <option value="">Chargement des dates disponibles...</option>
                    </select>
                    <small class="form-help">Seules les 5 dates les plus r√©centes avec des donn√©es sont affich√©es</small>
                </div>
                
                <div id="copy-source-preview" class="copy-preview" style="display: none;">
                    <h4>Aper√ßu des donn√©es √† copier :</h4>
                    <div class="preview-content">
                        <!-- Les donn√©es seront affich√©es ici -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeCopyStockModal()">
                    <i class="fas fa-times"></i> Annuler
                </button>
                <button type="button" class="btn btn-primary" id="confirm-copy-btn" onclick="confirmCopyStockData()" disabled>
                    <i class="fas fa-copy"></i> Copier les donn√©es
                </button>
            </div>
        </div>
    </div>

    <!-- Modal D√©tails PL -->
    <div id="pl-details-modal" class="modal">
        <div class="modal-content pl-details-modal">
            <div class="modal-header">
                <h2><i class="fas fa-calculator"></i> D√©tails du Calcul PL</h2>
                <div class="header-actions">
                    <button class="export-btn" onclick="exportPLDetailsToExcel()" title="Exporter en Excel">
                        <i class="fas fa-file-excel"></i> Excel
                    </button>
                    <span class="close" onclick="closePLDetailsModal()">&times;</span>
                </div>
            </div>
            <div class="modal-body">
                <div class="pl-details-container">
                    <!-- Section PL de base -->
                    <div class="pl-section">
                        <h3><i class="fas fa-chart-line"></i> PL de Base</h3>
                        <div class="pl-formula">
                            <div class="formula-item">
                                <span class="label">üí∞ Cash Bictorys du mois:</span>
                                <span class="value" id="pl-cash-bictorys">0 FCFA</span>
                            </div>
                            <div class="formula-item">
                                <span class="label">üí≥ Cr√©ances du mois:</span>
                                <span class="value" id="pl-creances">0 FCFA</span>
                            </div>
                            <div class="formula-item" onclick="togglePLDetails('stock-mata')" id="pl-stock-mata-item">
                                <span class="label">üì¶ √âcart Stock Mata Mensuel:</span>
                                <span class="value" id="pl-stock-mata">0 FCFA</span>
                            </div>
                            <div class="formula-details" id="pl-stock-mata-details" style="display: none;">
                                <div class="detail-line">
                                    <span class="detail-label">üìÖ Stock actuel (<span id="pl-stock-mata-current-date">DATE</span>):</span>
                                    <span class="detail-value" id="pl-stock-mata-current">0 FCFA</span>
                                </div>
                                <div class="detail-line">
                                    <span class="detail-label">üìÖ Stock pr√©c√©dent (<span id="pl-stock-mata-previous-date">DATE</span>):</span>
                                    <span class="detail-value" id="pl-stock-mata-previous">0 FCFA</span>
                                </div>
                                <div class="detail-line calculation">
                                    <span class="detail-label">‚û°Ô∏è √âcart:</span>
                                    <span class="detail-value" id="pl-stock-mata-calculation">0 - 0 = 0 FCFA</span>
                                </div>
                            </div>
                            <div class="formula-item negative">
                                <span class="label">üí∏ Cash Burn du mois:</span>
                                <span class="value" id="pl-cash-burn">0 FCFA</span>
                            </div>
                            <div class="formula-result">
                                <span class="label">üìä PL de base =</span>
                                <span class="value" id="pl-base-result">0 FCFA</span>
                            </div>
                        </div>
                    </div>

                    <!-- Section Ajustements -->
                    <div class="pl-section">
                        <h3><i class="fas fa-adjust"></i> Ajustements</h3>
                        <div class="pl-formula">
                            <div class="formula-item" onclick="togglePLDetails('stock-vivant')" id="pl-stock-vivant-item">
                                <span class="label">üå± √âcart Stock Vivant Mensuel:</span>
                                <span class="value" id="pl-stock-vivant">0 FCFA</span>
                            </div>
                            <div class="formula-details" id="pl-stock-vivant-details" style="display: none;">
                                <div class="detail-line">
                                    <span class="detail-label">üìÖ Stock actuel (<span id="pl-stock-vivant-current-date">DATE</span>):</span>
                                    <span class="detail-value" id="pl-stock-vivant-current">0 FCFA</span>
                                </div>
                                <div class="detail-line">
                                    <span class="detail-label">üìÖ Stock pr√©c√©dent (<span id="pl-stock-vivant-previous-date">DATE</span>):</span>
                                    <span class="detail-value" id="pl-stock-vivant-previous">0 FCFA</span>
                                </div>
                                <div class="detail-line calculation">
                                    <span class="detail-label">‚û°Ô∏è √âcart:</span>
                                    <span class="detail-value" id="pl-stock-vivant-calculation">0 - 0 = 0 FCFA</span>
                                </div>
                            </div>
                            <div class="formula-item negative" onclick="togglePLDetails('livraisons')" id="pl-livraisons-item">
                                <span class="label">üöö Livraisons partenaires du mois:</span>
                                <span class="value" id="pl-livraisons">0 FCFA</span>
                            </div>
                            <div class="formula-details" id="pl-livraisons-details" style="display: none;">
                                <div class="detail-line">
                                    <span class="detail-label">üìÖ P√©riode:</span>
                                    <span class="detail-value" id="pl-livraisons-period">du XX/XX/XXXX au XX/XX/XXXX</span>
                                </div>
                                <div class="detail-line">
                                    <span class="detail-label">‚úÖ Nombre de livraisons valid√©es:</span>
                                    <span class="detail-value" id="pl-livraisons-count">0</span>
                                </div>
                                <div class="detail-line">
                                    <span class="detail-label">‚è≥ Nombre de livraisons non valid√©es:</span>
                                    <span class="detail-value" id="pl-livraisons-count-non-validated">0</span>
                                </div>
                                <div class="livraisons-list" id="pl-livraisons-list">
                                    <!-- Les livraisons individuelles seront ajout√©es ici -->
                                </div>
                                <div class="detail-line calculation">
                                    <span class="detail-label">üí∞ Total livraisons:</span>
                                    <span class="detail-value" id="pl-livraisons-total">0 FCFA</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Section Charges Fixes -->
                    <div class="pl-section">
                        <h3><i class="fas fa-cogs"></i> Estimation Charges Fixes</h3>
                        <div class="pl-formula">
                            <div class="formula-item negative" onclick="togglePLDetails('charges-fixes')" id="pl-charges-fixes-item">
                                <span class="label">‚è∞ Charges prorata (jours ouvrables):</span>
                                <span class="value" id="pl-charges-prorata">0 FCFA</span>
                            </div>
                            <div class="formula-details" id="pl-charges-fixes-details" style="display: none;">
                                <div class="detail-line">
                                    <span class="detail-label">‚öôÔ∏è Estimation charges fixes mensuelle:</span>
                                    <span class="detail-value" id="pl-charges-fixes">0 FCFA</span>
                                </div>
                                <div class="detail-line">
                                    <span class="detail-label">üìÖ Jours ouvrables √©coul√©s:</span>
                                    <span class="detail-value" id="pl-jours-ouvrables">0</span>
                                </div>
                                <div class="detail-line">
                                    <span class="detail-label">üìÖ Total jours ouvrables dans le mois:</span>
                                    <span class="detail-value" id="pl-total-jours">0</span>
                                </div>
                                <div class="detail-line">
                                    <span class="detail-label">üìÖ Pourcentage du mois √©coul√©:</span>
                                    <span class="detail-value" id="pl-pourcentage">0%</span>
                                </div>
                                <div class="detail-line calculation">
                                    <span class="detail-label">üßÆ Calcul prorata:</span>
                                    <span class="detail-value" id="pl-charges-calculation">0 FCFA √ó 0% = 0 FCFA</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Section PL Final -->
                    <div class="pl-section final">
                        <h3><i class="fas fa-trophy"></i> PL Final</h3>
                        <div class="pl-formula">
                            <div class="formula-result final">
                                <span class="label">üéØ PL FINAL =</span>
                                <span class="value" id="pl-final-result">0 FCFA</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closePLDetailsModal()">
                    <i class="fas fa-times"></i> Fermer
                </button>
            </div>
        </div>
    </div>

    <style>
        /* Styles pour les badges de type d'op√©ration */
        .badge {
            font-size: 0.75em;
            padding: 0.25em 0.5em;
            border-radius: 0.25rem;
            font-weight: 500;
        }
        
        .badge-success {
            background-color: #28a745;
            color: white;
        }
        
        .badge-primary {
            background-color: #007bff;
            color: white;
        }
        
        .badge-warning {
            background-color: #ffc107;
            color: #212529;
        }
        
        .badge-info {
            background-color: #17a2b8;
            color: white;
        }
        
        .badge-secondary {
            background-color: #6c757d;
            color: white;
        }
        
        /* Styles pour la pagination */
        #credit-pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background-color: #f8f9fa;
            border-radius: 0.375rem;
            border: 1px solid #dee2e6;
            margin-top: 1rem;
        }
        
        .pagination-info {
            font-size: 0.875rem;
            color: #6c757d;
            font-weight: 500;
        }
        
        .pagination-controls {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }
        
        .pagination-controls .btn {
            min-width: 40px;
            padding: 0.375rem 0.75rem;
        }
        
        /* Styles pour les boutons d'action */
        .btn-sm {
            padding: 0.2rem 0.4rem;
            font-size: 0.75rem;
            border-radius: 0.2rem;
            min-width: 28px;
            height: 28px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #ddd;
            cursor: pointer;
            transition: all 0.2s;
            margin: 0 1px;
        }
        
        .btn-sm:hover {
            transform: scale(1.05);
        }
        
        .btn-warning {
            background-color: #ffc107;
            color: #212529;
        }
        
        .btn-warning:hover {
            background-color: #e0a800;
        }
        
        .btn-danger {
            background-color: #dc3545 !important;
            color: white !important;
            border-color: #dc3545 !important;
            display: inline-flex !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        .btn-danger:hover {
            background-color: #c82333 !important;
            border-color: #c82333 !important;
        }
        
        /* Forcer l'affichage des boutons de suppression */
        .btn-danger[onclick*="deleteCredit"] {
            display: inline-flex !important;
            visibility: visible !important;
            opacity: 1 !important;
            background-color: #dc3545 !important;
            color: white !important;
            border: 1px solid #dc3545 !important;
            min-width: 28px !important;
            height: 28px !important;
            margin-left: 4px !important;
        }
        
        .me-1 {
            margin-right: 0.25rem;
        }
        
        .ms-1 {
            margin-left: 0.25rem;
        }
        
        /* Styles pour les ic√¥nes dans les boutons */
        .btn-sm i {
            font-size: 10px !important;
            line-height: 1;
        }
        
        /* Styles pour la colonne Actions */
        #credit-history-table td:last-child {
            text-align: center;
            white-space: nowrap;
        }
        
        /* Styles pour les filtres de cr√©dit */
        .credit-filters {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid #dee2e6;
            display: flex;
            gap: 1.5rem;
            align-items: end;
            flex-wrap: wrap;
        }
        
        .credit-filters .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            min-width: 200px;
        }
        
        .credit-filters label {
            font-weight: 500;
            color: #495057;
            font-size: 0.875rem;
        }
        
        .credit-filters .form-control {
            padding: 0.75rem;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 0.875rem;
            background-color: white;
            transition: border-color 0.15s ease-in-out;
        }
        
        .credit-filters .form-control:focus {
            outline: none;
            border-color: #80bdff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
        }
        
        .credit-filters .btn {
            padding: 0.75rem 1rem;
            border-radius: 4px;
            font-weight: 500;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .credit-filters .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
        
        .credit-filters .btn-secondary:hover {
            background-color: #5a6268;
        }
        
        /* Responsive pour les filtres */
        @media (max-width: 768px) {
            .credit-filters {
                flex-direction: column;
                gap: 1rem;
            }
            
            .credit-filters .filter-group {
                min-width: auto;
                width: 100%;
            }
        }
        
        /* Responsive pour la pagination */
        @media (max-width: 768px) {
            #credit-pagination {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            .pagination-controls {
                flex-wrap: wrap;
                justify-content: center;
            }
        }
        
        /* Styles pour le modal de modification */
        .modal {
            display: none;
            position: fixed;
            z-index: 1050;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            overflow-y: auto;
            padding: 20px;
            box-sizing: border-box;
        }
        
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-dialog {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .modal-content {
            position: relative;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.5rem 1.5rem 1rem 1.5rem;
            border-bottom: 1px solid #e9ecef;
            background-color: #f8f9fa;
            border-radius: 8px 8px 0 0;
        }
        
        .modal-title {
            margin: 0;
            font-size: 1.25rem;
            font-weight: 600;
            color: #495057;
        }
        
        .btn-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6c757d;
            border-radius: 4px;
            transition: all 0.2s;
        }
        
        .btn-close:hover {
            color: #000;
            background-color: #e9ecef;
        }
        
        .modal-body {
            padding: 1.5rem;
        }
        
        .modal-body .form-row {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .modal-body .form-group {
            flex: 1;
        }
        
        .modal-body .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #495057;
        }
        
        .modal-body .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 0.875rem;
            transition: border-color 0.15s ease-in-out;
        }
        
        .modal-body .form-control:focus {
            outline: none;
            border-color: #80bdff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
        }
        
        .modal-body .form-control-plaintext {
            padding: 0.75rem;
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            color: #495057;
            font-weight: 500;
        }
        
        .modal-body .alert {
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 4px;
            border: 1px solid transparent;
        }
        
        .modal-body .alert-warning {
            color: #856404;
            background-color: #fff3cd;
            border-color: #ffeaa7;
        }
        
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 0.75rem;
            padding: 1rem 1.5rem 1.5rem 1.5rem;
            border-top: 1px solid #e9ecef;
            background-color: #f8f9fa;
            border-radius: 0 0 8px 8px;
        }
        
        /* Styles pour les contr√¥les d'audit de coh√©rence */
        .audit-consistency-controls {
            margin-top: 1rem;
            padding: 1rem;
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
        }
        
        .consistency-buttons {
            display: flex;
            gap: 1rem;
            margin-bottom: 0.5rem;
        }
        
        .consistency-info {
            margin-top: 0.5rem;
        }
        
        .consistency-info small {
            color: #6c757d;
            font-style: italic;
        }
        
        /* Styles pour les r√©sultats de coh√©rence */
        .audit-consistency-results {
            margin-top: 2rem;
            padding: 1.5rem;
            background-color: #fff;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .consistency-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #ffc107;
        }
        
        .consistency-header h3 {
            color: #856404;
            margin: 0;
        }
        
        .consistency-stats {
            display: flex;
            gap: 1rem;
        }
        
        .consistency-stats .stat-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #856404;
            font-weight: 500;
        }
        
        .consistency-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 1px solid #e9ecef;
        }
        
        /* Styles pour les diff√©rences dans le tableau */
        .difference-positive {
            color: #28a745;
            font-weight: 600;
        }
        
        .difference-negative {
            color: #dc3545;
            font-weight: 600;
        }
        
        .difference-zero {
            color: #6c757d;
            font-weight: 500;
        }
        
        .modal-footer .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 4px;
            font-weight: 500;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .modal-footer .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
        
        .modal-footer .btn-secondary:hover {
            background-color: #5a6268;
        }
        
        .modal-footer .btn-warning {
            background-color: #ffc107;
            color: #212529;
        }
        
        .modal-footer .btn-warning:hover {
            background-color: #e0a800;
        }
        
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1040;
        }
        
        /* Styles pour les d√©tails PL */
        .formula-details {
            margin-left: 20px;
            margin-top: 10px;
            padding: 10px;
            background-color: #f8f9fa;
            border-left: 3px solid #007bff;
            border-radius: 4px;
            font-size: 0.9em;
            display: none;
            transition: all 0.3s ease;
        }
        
        .formula-details.show {
            display: block;
            animation: slideDown 0.3s ease;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .detail-line {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
            padding: 3px 0;
        }
        
        .detail-line:last-child {
            margin-bottom: 0;
        }
        
        .detail-line.calculation {
            border-top: 1px solid #dee2e6;
            margin-top: 8px;
            padding-top: 8px;
            font-weight: 600;
            color: #495057;
        }
        
        .detail-label {
            font-weight: 500;
            color: #6c757d;
        }
        
        .detail-value {
            font-weight: 600;
            color: #212529;
        }
        
        /* Indicateur cliquable */
        .formula-item {
            position: relative;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        
        .formula-item:hover {
            background-color: #f8f9fa;
            border-radius: 4px;
        }
        
        .formula-item::after {
            content: "‚ìò";
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #007bff;
            font-size: 14px;
            opacity: 0.7;
            transition: opacity 0.2s ease;
        }
        
        .formula-item:hover::after {
            opacity: 1;
        }
        
        .formula-item.expanded::after {
            content: "‚ñº";
            color: #28a745;
        }
        
        /* Styles pour la liste des livraisons */
        .livraisons-list {
            margin: 10px 0;
            padding: 0;
        }
        
        .livraison-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            margin: 5px 0;
            background-color: #ffffff;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            font-size: 0.85em;
        }
        
        .livraison-info {
            display: flex;
            flex-direction: column;
            flex: 1;
        }
        
        .livraison-partner {
            font-weight: 600;
            color: #495057;
            margin-bottom: 2px;
        }
        
        .livraison-date {
            font-size: 0.9em;
            color: #6c757d;
        }
        
        .livraison-amount {
            font-weight: 600;
            color: #28a745;
            white-space: nowrap;
        }
        
        /* Responsive pour le modal */
        @media (max-width: 768px) {
            .modal {
                padding: 10px;
            }
            
            .modal-body .form-row {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .modal-footer {
                flex-direction: column;
            }
            
            .modal-footer .btn {
                width: 100%;
            }
            
            .formula-details {
                margin-left: 10px;
                font-size: 0.8em;
            }
            
            .detail-line {
                flex-direction: column;
                align-items: flex-start;
                gap: 2px;
            }
        }

        /* Styles pour la configuration financi√®re */
        .financial-settings-panel {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .financial-settings-panel h4 {
            color: #495057;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .custom-control-label {
            font-weight: 500;
            color: #495057;
        }

        #validation-status-text {
            margin-left: 5px;
        }

        .financial-settings-panel .alert-info {
            margin-bottom: 0;
            margin-top: 15px;
        }

        /* Styles pour le slider moderne de validation */
        .validation-slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: #ffffff;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            margin-top: 8px;
            transition: box-shadow 0.3s ease;
        }

        .validation-slider-container:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .slider-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }

        .slider-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #dc3545;
            transition: .4s;
            border-radius: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        input:checked + .slider {
            background-color: #28a745;
        }

        input:focus + .slider {
            box-shadow: 0 0 8px rgba(40, 167, 69, 0.3);
        }

        input:checked + .slider:before {
            transform: translateX(30px);
        }

        .slider-label {
            display: flex;
            flex-direction: column;
            flex: 1;
        }

        .slider-status {
            font-weight: 600;
            font-size: 16px;
            margin: 0;
            transition: color 0.3s ease;
        }

        .slider-status.enabled {
            color: #28a745;
        }

        .slider-status.disabled {
            color: #dc3545;
        }

        .slider-description {
            font-size: 14px;
            color: #6c757d;
            margin: 4px 0 0 0;
            line-height: 1.3;
        }

        .slider-icon {
            font-size: 24px;
            margin-left: 10px;
            transition: color 0.3s ease;
        }

        .slider-icon.enabled {
            color: #28a745;
        }

        .slider-icon.disabled {
            color: #dc3545;
        }

        .config-panel .form-group label {
            font-weight: 600;
            color: #495057;
        }

        .config-panel .form-group label i {
            margin-right: 8px;
            color: #6c757d;
        }

        /* Styles pour l'indicateur de validation des d√©penses */
        .validation-status-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .validation-content {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .validation-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }

        .validation-status-card.enabled {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-color: #c3e6cb;
        }

        .validation-status-card.disabled {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            border-color: #f5c6cb;
        }

        .validation-status-card.enabled #validation-icon {
            color: #155724;
        }

        .validation-status-card.disabled #validation-icon {
            color: #721c24;
        }

        .validation-status-card.enabled #validation-message {
            color: #155724;
        }

        .validation-status-card.disabled #validation-message {
            color: #721c24;
        }

        .validation-help {
            color: #6c757d;
            font-size: 0.9em;
            margin-left: 30px;
        }

        /* ========================================
         * üì∏ STYLES POUR LES SNAPSHOTS
         * ======================================== */
        
        .snapshots-controls-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            color: white;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }
        
        .control-panel {
            display: flex;
            flex-wrap: wrap;
            align-items: end;
            gap: 20px;
        }
        
        .control-panel .form-group {
            flex: 1;
            min-width: 250px;
        }
        
        .control-panel .form-group label {
            color: white;
            font-weight: 600;
            margin-bottom: 8px;
            display: block;
        }
        
        .control-panel .form-group .form-control {
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            padding: 10px 15px;
            color: #333;
            transition: all 0.3s ease;
        }
        
        .control-panel .form-group .form-control:focus {
            background: white;
            border-color: #ffd700;
            box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.3);
        }
        
        .control-panel .form-help {
            color: rgba(255, 255, 255, 0.9);
            font-size: 12px;
            margin-top: 5px;
        }
        
        #create-snapshot-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            border: none;
            color: white;
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }
        
        #create-snapshot-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
        }
        
        #refresh-snapshots-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        #refresh-snapshots-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
        }
        
        .snapshots-list-section .section-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            margin-bottom: 25px;
        }
        
        .snapshots-list-section .section-card h3 {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 20px 25px;
            margin: 0;
            color: #495057;
            border-bottom: 1px solid #dee2e6;
            font-weight: 600;
        }
        
        .snapshots-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
            padding: 25px;
        }
        
        .snapshot-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .snapshot-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        }
        
        .snapshot-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: #667eea;
        }
        
        .snapshot-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .snapshot-date {
            font-size: 18px;
            font-weight: 700;
            color: #495057;
        }
        
        .snapshot-size {
            background: #e9ecef;
            color: #6c757d;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .snapshot-card-body {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .snapshot-meta {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #6c757d;
            font-size: 14px;
        }
        
        .snapshot-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e9ecef;
        }
        
        .snapshot-actions .btn {
            flex: 1;
            padding: 8px 15px;
            font-size: 12px;
            border-radius: 6px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .btn-view-snapshot {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            border: none;
            color: white;
        }
        
        .btn-view-snapshot:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
        }
        
        .btn-delete-snapshot {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            border: none;
            color: white;
        }
        
        .btn-delete-snapshot:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(220, 53, 69, 0.3);
        }
        
        .no-data-message {
            text-align: center;
            padding: 60px 20px;
            color: #6c757d;
        }
        
        .no-data-message i {
            font-size: 48px;
            margin-bottom: 20px;
            color: #dee2e6;
        }
        
        .no-data-message p {
            font-size: 18px;
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .no-data-message small {
            font-size: 14px;
            color: #adb5bd;
        }
        
        /* Styles pour le visualiseur de snapshots */
        .snapshot-viewer {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            margin-top: 25px;
            overflow: hidden;
        }
        
        .viewer-header {
            background: linear-gradient(135deg, #495057 0%, #343a40 100%);
            color: white;
            padding: 20px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .viewer-header h3 {
            margin: 0;
            font-weight: 600;
        }
        
        .snapshot-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            overflow-x: auto;
        }
        
        .tab-btn {
            background: none;
            border: none;
            padding: 15px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            color: #6c757d;
            font-weight: 500;
            border-bottom: 3px solid transparent;
        }
        
        .tab-btn:hover {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }
        
        .tab-btn.active {
            background: white;
            color: #667eea;
            border-bottom-color: #667eea;
        }
        
        .tab-content {
            min-height: 400px;
        }
        
        .tab-pane {
            display: none;
            padding: 25px;
        }
        
        .tab-pane.active {
            display: block;
        }
        
        .snapshot-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .snapshot-stat-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .snapshot-stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .snapshot-stat-card .stat-icon {
            font-size: 32px;
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .snapshot-stat-card .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #495057;
            margin-bottom: 5px;
        }
        
        .snapshot-stat-card .stat-label {
            color: #6c757d;
            font-size: 14px;
            font-weight: 500;
        }
        
        .loading-message {
            text-align: center;
            padding: 40px 20px;
            color: #667eea;
            font-size: 16px;
        }
        
        .loading-message i {
            font-size: 24px;
            margin-right: 10px;
        }
        
        /* Responsive design pour les snapshots */
        @media (max-width: 768px) {
            .control-panel {
                flex-direction: column;
                align-items: stretch;
            }
            
            .control-panel .form-group {
                min-width: 100%;
                margin-bottom: 15px;
            }
            
            .snapshots-grid {
                grid-template-columns: 1fr;
                padding: 15px;
            }
            
            .snapshot-actions {
                flex-direction: column;
            }
            
            .snapshot-tabs {
                flex-wrap: wrap;
            }
            
            .tab-btn {
                flex: 1;
                min-width: 120px;
            }
            
            .snapshot-stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>

    <!-- Modal pour les d√©tails du Cash disponible -->
    <div id="cash-detail-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-info-circle"></i> D√©tail du Cash disponible</h3>
                <button class="close-btn" id="close-cash-detail">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="cash-detail-content">
                    <!-- Le contenu sera g√©n√©r√© dynamiquement -->
                </div>
            </div>
        </div>
    </div>
    
    <script src="app.js"></script>
    <script src="snapshots.js"></script>
</body>
</html> 